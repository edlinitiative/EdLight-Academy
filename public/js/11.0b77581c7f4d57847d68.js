"use strict";(self.webpackChunkedlight_academy=self.webpackChunkedlight_academy||[]).push([[11],{6011:(e,a,s)=>{s.r(a),s.d(a,{default:()=>E});var t=s(4705),n=s(6540),l=s(7767),r=s(1444),i=s(7028),c=s(3212),o=s(7791),d=s(9920),u=s(4848);function m(e,a){var s=Object.keys(e);if(Object.getOwnPropertySymbols){var t=Object.getOwnPropertySymbols(e);a&&(t=t.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),s.push.apply(s,t)}return s}function x(e){for(var a=1;a<arguments.length;a++){var s=null!=arguments[a]?arguments[a]:{};a%2?m(Object(s),!0).forEach(function(a){(0,t.A)(e,a,s[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(s)):m(Object(s)).forEach(function(a){Object.defineProperty(e,a,Object.getOwnPropertyDescriptor(s,a))})}return e}function h(e,a){return e._displayNumber||String(a+1)}function p(e){let{text:a}=e;const s=(0,o.n7)();return a?/\$/.test(a)||/\\\(/.test(a)?(0,u.jsx)("span",{dangerouslySetInnerHTML:(0,o.qZ)(a,s)}):(0,u.jsx)(u.Fragment,{children:a}):null}const _=[{key:"simplify",re:/\b(simplifier|rÃ©duire|Ã©crire.*sous.*forme|mettre.*sous.*forme)\b/i,label:"Simplification",icon:"âœ¨",scaffoldSteps:[{hint:"Identifiez et simplifiez chaque terme sÃ©parÃ©ment"},{hint:"Combinez les termes semblables"},{hint:"Ã‰crivez le rÃ©sultat sous la forme demandÃ©e"}],askFinalAnswer:!0,finalLabel:"RÃ©sultat simplifiÃ©"},{key:"factor",re:/\b(factoriser)\b/i,label:"Factorisation",icon:"ðŸ”—",scaffoldSteps:[{hint:"Identifiez le facteur commun ou l'identitÃ© remarquable"},{hint:"Mettez en facteur"},{hint:"VÃ©rifiez en dÃ©veloppant"}],askFinalAnswer:!0,finalLabel:"Forme factorisÃ©e"},{key:"solve",re:/\b(rÃ©soudre|trouver.*solution|dÃ©terminer.*valeur|trouver.*valeur)\b/i,label:"RÃ©solution",icon:"ðŸ”",scaffoldSteps:[{hint:"Posez l'Ã©quation ou identifiez les donnÃ©es"},{hint:"Isolez l'inconnue Ã©tape par Ã©tape"},{hint:"VÃ©rifiez la / les solution(s)"}],askFinalAnswer:!0,finalLabel:"Solution(s)"},{key:"calculate",re:/\b(calculer|Ã©valuer|dÃ©terminer)\b/i,label:"Calcul",icon:"ðŸ§®",scaffoldSteps:[{hint:"Posez le calcul avec les donnÃ©es"},{hint:"Effectuez les opÃ©rations"}],askFinalAnswer:!0,finalLabel:"RÃ©sultat"},{key:"prove",re:/\b(montrer\s+que|dÃ©montrer|prouver\s+que|dÃ©duire\s+que|vÃ©rifier\s+que|justifier\s+que|en\s+dÃ©duire)\b/i,label:"DÃ©monstration",icon:"ðŸ“",scaffoldSteps:[{hint:"Partez de l'hypothÃ¨se ou de l'expression de dÃ©part"},{hint:"DÃ©veloppez le raisonnement"},{hint:"Concluez en retrouvant le rÃ©sultat demandÃ©"}],askFinalAnswer:!1,finalLabel:""},{key:"develop",re:/\b(dÃ©velopper|dÃ©velopper\s+et\s+rÃ©duire)\b/i,label:"DÃ©veloppement",icon:"ðŸ“–",scaffoldSteps:[{hint:"Appliquez la distributivitÃ© ou l'identitÃ© remarquable"},{hint:"RÃ©duisez les termes semblables"}],askFinalAnswer:!0,finalLabel:"Forme dÃ©veloppÃ©e"}],v={key:"generic",label:"Raisonnement",icon:"ðŸ’¡",scaffoldSteps:[{hint:"PremiÃ¨re Ã©tape de votre raisonnement"},{hint:"Continuezâ€¦"}],askFinalAnswer:!0,finalLabel:"RÃ©sultat final"},f=/\b(montrer\s+que|dÃ©montrer|prouver\s+que|dÃ©duire\s+que|vÃ©rifier\s+que|justifier\s+que|en\s+dÃ©duire|simplifier|factoriser|dÃ©velopper\s+et\s+rÃ©duire|calculer\s+et\s+simplifier|rÃ©soudre\s+(dans|l['']Ã©quation)|dÃ©terminer)\b/i;function j(e){const a=e._displayText||e.question||"",s=e.type||"";return!!["calculation","short_answer","essay"].includes(s)&&f.test(a)}const k=/_{4,}|\.{4,}/g;function g(e){let{title:a,instructions:s}=e;const[t,l]=(0,n.useState)(!1),r=!(null==s||!s.trim());return(0,u.jsxs)("div",{className:"exam-take__section-header",children:[(0,u.jsxs)("div",{className:"exam-take__section-header-top",onClick:()=>r&&l(e=>!e),role:r?"button":void 0,tabIndex:r?0:void 0,onKeyDown:e=>{!r||"Enter"!==e.key&&" "!==e.key||(e.preventDefault(),l(e=>!e))},children:[(0,u.jsx)("h3",{children:a}),r&&(0,u.jsx)("button",{className:"exam-take__section-toggle",type:"button","aria-label":t?"Afficher les instructions":"Masquer les instructions",tabIndex:-1,children:t?"â–¶":"â–¼"})]}),r&&!t&&(0,u.jsx)(c.A,{text:s})]})}function b(e){let{text:a}=e;const[s,t]=(0,n.useState)(!0);return a?(0,u.jsxs)("div",{className:"exam-take__reading-passage ".concat(s?"":"exam-take__reading-passage--collapsed"),children:[(0,u.jsxs)("div",{className:"exam-take__reading-passage-bar",onClick:()=>t(e=>!e),children:[(0,u.jsx)("span",{className:"exam-take__reading-passage-icon",children:"ðŸ“–"}),(0,u.jsx)("span",{className:"exam-take__reading-passage-label",children:"Texte de rÃ©fÃ©rence"}),(0,u.jsx)("button",{className:"exam-take__reading-passage-toggle",type:"button","aria-label":s?"RÃ©duire le texte":"Afficher le texte",tabIndex:-1,children:s?"â–² RÃ©duire":"â–¼ Afficher le texte"})]}),s&&(0,u.jsx)("div",{className:"exam-take__reading-passage-body",children:(0,u.jsx)(c.A,{text:a})})]}):null}function N(e){let{text:a,index:s,value:t,onChange:l}=e;const r=a.split(k),i=r.length-1,c=i>1?(t||"").split("|").concat(Array(i).fill("")).slice(0,i):[t||""],o=/^\s*\(([^)]+)\)/;return(0,u.jsx)("div",{className:"exam-take__fill-blank-text",children:r.map((e,a)=>{let t="",r=e;if(a>0){const a=e.match(o);a&&(t=a[1],r=e.slice(a[0].length))}return(0,u.jsxs)(n.Fragment,{children:[a>0&&(0,u.jsxs)("span",{className:"exam-take__inline-blank-wrap",children:[t&&(0,u.jsx)("span",{className:"exam-take__inline-blank-hint",children:t}),(0,u.jsx)("input",{type:"text",className:"exam-take__inline-blank",value:c[a-1],onChange:e=>((e,a)=>{if(i<=1)l(s,a);else{const t=[...c];t[e]=a,l(s,t.join("|"))}})(a-1,e.target.value),placeholder:t||"â€¦",autoComplete:"off",spellCheck:"false",style:t?{minWidth:"".concat(Math.max(.6*t.length+2,5),"em")}:void 0})]}),r&&(0,u.jsx)("span",{children:(0,u.jsx)(p,{text:r})})]},a)})})}function y(e){let{hints:a}=e;const[s,t]=(0,n.useState)(0);if(!a||!Array.isArray(a)||0===a.length)return null;const l=s<a.length;return(0,u.jsxs)("div",{className:"qa-hints",children:[a.slice(0,s).map((e,a)=>(0,u.jsxs)("div",{className:"qa-hints__item",style:{animationDelay:"".concat(.05*a,"s")},children:[(0,u.jsx)("span",{className:"qa-hints__icon",children:"ðŸ’¡"}),(0,u.jsx)("span",{className:"qa-hints__text",children:(0,u.jsx)(p,{text:e})})]},a)),l&&(0,u.jsxs)("button",{type:"button",className:"qa-hints__btn",onClick:()=>t(e=>e+1),children:["ðŸ’¡ ",0===s?"Obtenir un indice":"Indice suivant"," ",(0,u.jsxs)("span",{className:"qa-hints__counter",children:["(",s,"/",a.length,")"]})]})]})}function C(e){let{question:a,index:s,value:t,onChange:l}=e;const r=a.scaffold_text,i=a.scaffold_blanks||[],c=a.answer_parts||[],o=c.length>0,[d,m]=n.useState({}),h=(0,n.useMemo)(()=>{if(!t)return i.map(()=>"");try{const e=JSON.parse(t);if(e&&e.scaffold&&Array.isArray(e.scaffold)){const a=e.scaffold;return i.map((e,s)=>a[s]||"")}}catch(e){}return i.map(()=>"")},[t,i]),_=(0,n.useCallback)(e=>{l(s,JSON.stringify({scaffold:e}))},[s,l]),v=(0,n.useCallback)((e,a)=>{const s=[...h];s[e]=a,m(a=>x(x({},a),{},{[e]:void 0})),_(s)},[h,_]),f=(0,n.useCallback)(e=>{if(!o||!c[e])return;const a=(h[e]||"").trim();if(!a)return;const s=c[e],t=[s.answer,...s.alternatives||[]],n=e=>(e||"").toString().trim().toLowerCase().normalize("NFD").replace(/[\u0300-\u036f]/g,"").replace(/^\$+|\$+$/g,"").replace(/\\text\{([^}]*)\}/g,"$1").replace(/\\,/g,"").replace(/\s+/g," ").trim(),l=n(a);let r=!1;for(const e of t){const a=n(e);if(!a)continue;if(l===a){r=!0;break}const s=parseFloat(l.replace(/,/g,".")),t=parseFloat(a.replace(/,/g,"."));if(!isNaN(s)&&!isNaN(t)&&Math.abs(s-t)<=Math.max(.01*Math.abs(t),.01)){r=!0;break}}m(a=>x(x({},a),{},{[e]:r}))},[o,c,h]),j=h.filter(e=>e.trim()).length,k=Object.values(d).filter(e=>!0===e).length,g=i.length;if(!r||0===g)return null;const b=[],N=/\{\{(\d+)\}\}/g;let y,C=0;for(;null!==(y=N.exec(r));)y.index>C&&b.push({type:"text",content:r.slice(C,y.index)}),b.push({type:"blank",blankIdx:parseInt(y[1],10)}),C=y.index+y[0].length;return C<r.length&&b.push({type:"text",content:r.slice(C)}),(0,u.jsxs)("div",{className:"scaffold",children:[(0,u.jsxs)("div",{className:"scaffold__header",children:[(0,u.jsx)("span",{className:"scaffold__badge",children:"ðŸ“ RÃ©ponse guidÃ©e"}),(0,u.jsxs)("span",{className:"scaffold__progress",children:[o&&k>0&&(0,u.jsxs)("span",{className:"scaffold__correct-count",children:["âœ“ ",k," "]}),j,"/",g," complÃ©tÃ©",1!==j?"s":""]})]}),(0,u.jsx)("div",{className:"scaffold__body",children:b.map((e,a)=>{var s;if("text"===e.type)return e.content.split("\n").map((e,s)=>(0,u.jsxs)(n.Fragment,{children:[s>0&&(0,u.jsx)("br",{}),(0,u.jsx)(p,{text:e})]},"".concat(a,"-").concat(s)));const t=e.blankIdx,l=i[t];if(!l)return null;const r=d[t],c=!0===r?"scaffold__blank--correct":!1===r?"scaffold__blank--incorrect":null!==(s=h[t])&&void 0!==s&&s.trim()?"scaffold__blank--filled":"";return(0,u.jsxs)("span",{className:"scaffold__blank-wrapper",children:[(0,u.jsx)("input",{className:"scaffold__blank ".concat(c),type:"text",value:h[t]||"",onChange:e=>v(t,e.target.value),onBlur:()=>f(t),placeholder:l.label||"RÃ©ponse ".concat(t+1),"aria-label":l.label||"Blank ".concat(t+1)}),!0===r&&(0,u.jsx)("span",{className:"scaffold__blank-check",children:"âœ“"}),!1===r&&(0,u.jsx)("span",{className:"scaffold__blank-cross",children:"âœ—"}),l.label&&(0,u.jsx)("span",{className:"scaffold__blank-label",children:l.label})]},"b-".concat(t))})})]})}function w(e){let{question:a,index:s,value:t,onChange:n}=e;const l=a.type||"unknown";if(j(a))return(0,u.jsx)(A,{question:a,index:s,value:t,onChange:n});switch(l){case"multiple_choice":return(0,u.jsx)(M,{question:a,index:s,value:t,onChange:n});case"true_false":return(0,u.jsx)(P,{index:s,value:t,onChange:n});case"fill_blank":case"calculation":case"short_answer":default:return(0,u.jsx)(z,{type:l,index:s,value:t,onChange:n});case"essay":return(0,u.jsx)(L,{index:s,value:t,onChange:n});case"matching":return(0,u.jsx)(O,{question:a,index:s,value:t,onChange:n})}}const q=["","Par dÃ©finition","Par hypothÃ¨se","Par simplification","Par factorisation","Par substitution","Par identitÃ© remarquable","Par calcul","Par dÃ©veloppement","Par rÃ©currence","Par l'absurde","Par contraposÃ©e","D'aprÃ¨s le thÃ©orÃ¨me","En utilisant la propriÃ©tÃ©","On en dÃ©duit que","Autre"],S=["Bien jouÃ© ! ðŸŽ‰","Super ! Continue ðŸ’ª","Bravo ! ðŸ‘","Excellent travail ! â­","Bien raisonnÃ© ! ðŸ§ "];function A(e){let{question:a,index:s,value:t,onChange:l}=e;const r=(0,o.n7)(),i=(null==a?void 0:a._displayText)||(null==a?void 0:a.question)||"",c=(0,n.useMemo)(()=>function(e){for(const a of _)if(a.re.test(e))return a;return v}(i),[i]),[d,m]=(0,n.useState)(0),[h,p]=(0,n.useState)(""),{steps:f,finalAnswer:j}=(0,n.useMemo)(()=>{if(!t)return{steps:c.scaffoldSteps.map(()=>({math:"",justification:""})),finalAnswer:""};try{const e=JSON.parse(t);if(e&&e.steps&&Array.isArray(e.steps))return{steps:e.steps,finalAnswer:e.finalAnswer||""};if(Array.isArray(e)&&e.length>0)return{steps:e,finalAnswer:""}}catch(e){}return"string"==typeof t&&t.trim()?{steps:[{math:t,justification:""}],finalAnswer:""}:{steps:c.scaffoldSteps.map(()=>({math:"",justification:""})),finalAnswer:""}},[t,c]),k=f.filter(e=>{var a;return null===(a=e.math)||void 0===a?void 0:a.trim()}).length,g=f.length,b=g>0?Math.round(k/g*100):0,N=(0,n.useCallback)((e,a)=>{l(s,JSON.stringify({steps:e,finalAnswer:a}))},[s,l]),y=(0,n.useCallback)((e,a,s)=>{var t;const n=f.map((t,n)=>n===e?x(x({},t),{},{[a]:s}):t);"math"!==a||!s.trim()||null!==(t=f[e].math)&&void 0!==t&&t.trim()||(p(S[Math.floor(Math.random()*S.length)]),setTimeout(()=>p(""),2e3)),N(n,j)},[f,j,N]),C=(0,n.useCallback)(()=>{N([...f,{math:"",justification:""}],j)},[f,j,N]),w=(0,n.useCallback)(e=>{f.length<=1||N(f.filter((a,s)=>s!==e),j)},[f,j,N]),q=(0,n.useCallback)(e=>{N(f,e)},[f,N]),A=(0,n.useCallback)(()=>{m(e=>Math.min(e+1,c.scaffoldSteps.length))},[c]),M=d<c.scaffoldSteps.length;return(0,u.jsxs)("div",{className:"ka-proof",children:[(0,u.jsxs)("div",{className:"ka-proof__header",children:[(0,u.jsx)("div",{className:"ka-proof__header-left",children:(0,u.jsxs)("span",{className:"ka-proof__type-badge",children:[c.icon||"ðŸ“"," ",c.label]})}),(0,u.jsx)("div",{className:"ka-proof__header-right",children:(0,u.jsxs)("div",{className:"ka-proof__progress",children:[(0,u.jsx)("div",{className:"ka-proof__progress-bar",children:(0,u.jsx)("div",{className:"ka-proof__progress-fill",style:{width:"".concat(b,"%")}})}),(0,u.jsxs)("span",{className:"ka-proof__progress-text",children:[k,"/",g]})]})})]}),h&&(0,u.jsx)("div",{className:"ka-proof__encouragement",children:h}),(0,u.jsx)("div",{className:"ka-proof__timeline",children:f.map((e,a)=>{var s,t,n;const l=!(null===(s=e.math)||void 0===s||!s.trim()),i=!(l||0!==a&&(null===(t=f[a-1])||void 0===t||null===(t=t.math)||void 0===t||!t.trim())),m=(null===(n=c.scaffoldSteps[a])||void 0===n?void 0:n.hint)||"",x=a<d;return(0,u.jsxs)("div",{className:"ka-step ".concat(l?"ka-step--done":""," ").concat(i?"ka-step--active":""),children:[(0,u.jsxs)("div",{className:"ka-step__rail",children:[(0,u.jsx)("div",{className:"ka-step__dot",children:l?(0,u.jsx)("svg",{width:"12",height:"12",viewBox:"0 0 12 12",fill:"none",children:(0,u.jsx)("path",{d:"M2 6l3 3 5-5",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"})}):(0,u.jsx)("span",{className:"ka-step__dot-number",children:a+1})}),a<g-1&&(0,u.jsx)("div",{className:"ka-step__connector"})]}),(0,u.jsxs)("div",{className:"ka-step__content",children:[(0,u.jsxs)("div",{className:"ka-step__label",children:["Ã‰tape ",a+1]}),x&&m&&!l&&(0,u.jsxs)("div",{className:"ka-step__hint",children:[(0,u.jsx)("span",{className:"ka-step__hint-icon",children:"ðŸ’¡"}),m]}),(0,u.jsx)("textarea",{className:"ka-step__input",value:e.math,onChange:e=>y(a,"math",e.target.value),placeholder:l?"":"Ã‰crivez votre expression iciâ€¦",rows:1,spellCheck:"false"}),e.math&&(/\$/.test(e.math)||/\\[a-zA-Z]/.test(e.math))&&r&&(0,u.jsx)("div",{className:"ka-step__preview",children:(0,u.jsx)("span",{dangerouslySetInnerHTML:(0,o.qZ)(e.math,r)})}),(0,u.jsx)(I,{value:e.justification,onChange:e=>y(a,"justification",e)}),g>1&&(0,u.jsx)("button",{type:"button",className:"ka-step__remove",onClick:()=>w(a),"aria-label":"Supprimer cette Ã©tape",children:"âœ•"})]})]},a)})}),(0,u.jsxs)("div",{className:"ka-proof__actions",children:[(0,u.jsx)("button",{type:"button",className:"ka-proof__add-btn",onClick:C,children:"+ Ajouter une Ã©tape"}),M&&(0,u.jsx)("button",{type:"button",className:"ka-proof__hint-btn",onClick:A,children:"ðŸ’¡ Obtenir un indice"})]}),c.askFinalAnswer&&(0,u.jsxs)("div",{className:"ka-proof__answer",children:[(0,u.jsxs)("div",{className:"ka-proof__answer-header",children:[(0,u.jsx)("span",{className:"ka-proof__answer-icon",children:"ðŸŽ¯"}),(0,u.jsx)("label",{className:"ka-proof__answer-label",children:c.finalLabel||"RÃ©sultat final"}),(0,u.jsx)("span",{className:"ka-proof__answer-badge",children:"VÃ©rifiÃ© automatiquement"})]}),(0,u.jsx)("input",{className:"ka-proof__answer-input",type:"text",value:j,onChange:e=>q(e.target.value),placeholder:"Votre ".concat((c.finalLabel||"rÃ©sultat").toLowerCase(),"â€¦")}),j&&(/\$/.test(j)||/\\[a-zA-Z]/.test(j))&&r&&(0,u.jsx)("div",{className:"ka-proof__answer-preview",children:(0,u.jsx)("span",{dangerouslySetInnerHTML:(0,o.qZ)(j,r)})})]})]})}function I(e){let{value:a,onChange:s}=e;const[t,l]=(0,n.useState)(!1);return t||a?(0,u.jsxs)("div",{className:"ka-justify",children:[(0,u.jsxs)("select",{className:"ka-justify__select",value:q.includes(a)?a:a?"Autre":"",onChange:e=>{const t=e.target.value;"Autre"===t?q.includes(a)&&s(""):s(t)},children:[(0,u.jsx)("option",{value:"",children:"â€” Choisir â€”"}),q.slice(1).map(e=>(0,u.jsx)("option",{value:e,children:e},e))]}),a&&!q.includes(a)&&(0,u.jsx)("input",{className:"ka-justify__custom",type:"text",value:a,onChange:e=>s(e.target.value),placeholder:"Justification personnalisÃ©eâ€¦"}),!a&&(0,u.jsx)("button",{type:"button",className:"ka-justify__close",onClick:()=>l(!1),children:"âœ•"})]}):(0,u.jsx)("button",{type:"button",className:"ka-justify__toggle",onClick:()=>l(!0),children:"+ Justification"})}function M(e){let{question:a,index:s,value:t,onChange:n}=e;const l=a.options||{},r=Object.entries(l);return 0===r.length?(0,u.jsxs)("div",{className:"exam-take__no-options",children:[(0,u.jsx)("p",{children:"Options non disponibles pour cette question. Tapez votre rÃ©ponse :"}),(0,u.jsx)("input",{className:"exam-take__text-input",type:"text",value:t,onChange:e=>n(s,e.target.value),placeholder:"Votre rÃ©ponseâ€¦"})]}):(0,u.jsx)("div",{className:"exam-take__mcq-options",children:r.map(e=>{let[a,l]=e;const r=t===a;return(0,u.jsxs)("label",{className:"exam-take__mcq-option ".concat(r?"exam-take__mcq-option--selected":""),children:[(0,u.jsx)("input",{type:"radio",name:"q-".concat(s),value:a,checked:r,onChange:()=>n(s,a),className:"exam-take__mcq-radio"}),(0,u.jsx)("span",{className:"exam-take__mcq-key",children:a.toUpperCase()}),(0,u.jsx)("span",{className:"exam-take__mcq-text",children:(0,u.jsx)(p,{text:l})})]},a)})})}function P(e){let{index:a,value:s,onChange:t}=e;return(0,u.jsx)("div",{className:"exam-take__tf-options",children:[{key:"vrai",label:"âœ… Vrai"},{key:"faux",label:"âŒ Faux"}].map(e=>{let{key:n,label:l}=e;const r=s===n;return(0,u.jsxs)("label",{className:"exam-take__tf-option ".concat(r?"exam-take__tf-option--selected":""),children:[(0,u.jsx)("input",{type:"radio",name:"q-".concat(a),value:n,checked:r,onChange:()=>t(a,n),className:"exam-take__tf-radio"}),(0,u.jsx)("span",{children:l})]},n)})})}function z(e){let{type:a,index:s,value:t,onChange:n}=e;return(0,u.jsx)("input",{className:"exam-take__text-input",type:"text",value:t,onChange:e=>n(s,e.target.value),placeholder:{fill_blank:"ComplÃ©tez le blancâ€¦",calculation:"Entrez votre rÃ©sultatâ€¦",short_answer:"Votre rÃ©ponseâ€¦"}[a]||"Votre rÃ©ponseâ€¦"})}function L(e){let{index:a,value:s,onChange:t}=e;return(0,u.jsx)("textarea",{className:"exam-take__essay-input",value:s,onChange:e=>t(a,e.target.value),placeholder:"RÃ©digez votre rÃ©ponse iciâ€¦",rows:8})}function O(e){let{question:a,index:s,value:t,onChange:n}=e;return(0,u.jsxs)("div",{className:"exam-take__matching",children:[(0,u.jsx)("p",{className:"exam-take__matching-hint",children:"Entrez vos correspondances (ex: 1-B, 2-A, 3-C)"}),(0,u.jsx)("input",{className:"exam-take__text-input",type:"text",value:t,onChange:e=>n(s,e.target.value),placeholder:"1-B, 2-A, 3-Câ€¦"})]})}const E=()=>{var e;const{examIndex:a}=(0,l.g)(),s=(0,l.Zp)(),{data:t,isLoading:m,error:_}=((0,o.n7)(),(0,r.I)({queryKey:["exam-catalog"],queryFn:async()=>{const e=await fetch("/exam_catalog.json");if(!e.ok)throw new Error("Failed to load exam catalog");return e.json()},staleTime:1/0})),v=parseInt(a,10),f=null==t?void 0:t[v],k=(0,n.useMemo)(()=>f?(0,d.Y)(f):[],[f]),q=(0,n.useMemo)(()=>{const e=[];for(let t=0;t<k.length;t++){var a,s;const n=String((null===(a=k[t])||void 0===a?void 0:a.sectionTitle)||"").trim()||"Questions",l=String((null===(s=k[t])||void 0===s?void 0:s.sectionInstructions)||"").trim(),r=e[e.length-1];r&&r.title===n&&r.instructions===l?r.end=t:e.push({title:n,instructions:l,start:t,end:t})}return e.map(e=>x(x({},e),{},{count:e.end-e.start+1}))},[k]),S=(0,n.useMemo)(()=>{const e=[];for(let a=0;a<k.length;a++){const s=k[a]._subExGroup,t=e[e.length-1];s&&t&&t.group===s?(t.end=a,t.indices.push(a)):e.push({group:s,start:a,end:a,indices:[a]})}return e},[k]),[A,I]=(0,n.useState)(!1),M=(0,n.useMemo)(()=>{if(!f)return null;let e=[];const a=(f.sections||[]).map(a=>{const s=(a.instructions||"").trim(),{rules:t,cleanedText:n}=(0,d.P5)(s);return t.length&&e.push(...t),x(x({},a),{},{_cleanInstructions:s?n:null,_hadRules:t.length>0})}),s=new Set;return{rules:e.filter(e=>{const a=e.toLowerCase().replace(/[^a-zÃ -Ã¿0-9]/gi,"").slice(0,40);return!s.has(a)&&(s.add(a),!0)}),cleanedSections:a}},[f]),[P,z]=(0,n.useState)(0),[L,O]=(0,n.useState)({}),[E,T]=(0,n.useState)(!1),[F,D]=(0,n.useState)(!1),R=(null==f?void 0:f.duration_minutes)||0,[B,V]=(0,n.useState)(60*R),$=(0,n.useRef)(null);(0,n.useEffect)(()=>{if(R&&!E)return V(60*R),$.current=setInterval(()=>{V(e=>e<=1?(clearInterval($.current),0):e-1)},1e3),()=>clearInterval($.current)},[R,E]),(0,n.useEffect)(()=>{R&&0===B&&!E&&K()},[B]);const J=e=>{const a=Math.floor(e/3600),s=Math.floor(e%3600/60),t=e%60;return a>0?"".concat(a,":").concat(String(s).padStart(2,"0"),":").concat(String(t).padStart(2,"0")):"".concat(s,":").concat(String(t).padStart(2,"0"))},W=(0,n.useCallback)((e,a)=>{O(s=>x(x({},s),{},{[e]:a}))},[]),Z=Object.keys(L).filter(e=>{const a=L[e];if(null==a||""===a)return!1;if("string"==typeof a&&a.startsWith("{")||a.startsWith("["))try{const e=JSON.parse(a);var s;if(e&&e.steps)return e.steps.some(e=>{var a;return null===(a=e.math)||void 0===a?void 0:a.trim()})||!(null===(s=e.finalAnswer)||void 0===s||!s.trim());if(Array.isArray(e))return e.some(e=>{var a;return null===(a=e.math)||void 0===a?void 0:a.trim()})}catch(e){}return!0}).length,G=k.length>0?Math.round(Z/k.length*100):0;(0,n.useEffect)(()=>{const e=e=>{"INPUT"===e.target.tagName||"TEXTAREA"===e.target.tagName||e.target.isContentEditable||("ArrowRight"===e.key||"ArrowDown"===e.key?(e.preventDefault(),z(e=>{const a=S.findIndex(a=>e>=a.start&&e<=a.end),s=S[a+1];return s?s.start:e})):"ArrowLeft"!==e.key&&"ArrowUp"!==e.key||(e.preventDefault(),z(e=>{const a=S.findIndex(a=>e>=a.start&&e<=a.end),s=S[a-1];return s?s.start:e})))};return window.addEventListener("keydown",e),()=>window.removeEventListener("keydown",e)},[k.length,S]);const H=(0,n.useRef)(null);(0,n.useEffect)(()=>{var e;null===(e=H.current)||void 0===e||e.scrollIntoView({behavior:"smooth",block:"start"})},[P]);const[U,Y]=(0,n.useState)(!1),K=(0,n.useCallback)(()=>{clearInterval($.current),T(!0);const e=(0,d.$4)(k,L);sessionStorage.setItem("exam-result-".concat(v),JSON.stringify({examIndex:v,examTitle:(0,d.Vj)(f),subject:(0,d.c$)(f.subject),level:(0,d.yf)(f.level),result:e,timestamp:Date.now()})),s("/exams/".concat(v,"/results"))},[k,L,v,f,s]);if(m)return(0,u.jsx)("section",{className:"section",children:(0,u.jsx)("div",{className:"container",children:(0,u.jsx)("div",{className:"card card--centered card--loading",children:(0,u.jsx)("div",{className:"loading-spinner"})})})});if(_||!f)return(0,u.jsx)("section",{className:"section",children:(0,u.jsx)("div",{className:"container",children:(0,u.jsxs)("div",{className:"card card--message",children:[(0,u.jsx)("p",{children:"Examen introuvable."}),(0,u.jsx)("button",{className:"button button--primary",onClick:()=>s("/exams"),children:"â† Retour aux examens"})]})})});const Q=(0,d.c$)(f.subject),X=(0,d.cS)(Q);if(!A){var ee;const e=(f.sections||[]).map((e,a)=>({title:e.section_title||"Section ".concat(a+1),qCount:(e.questions||[]).length})),a=e.reduce((e,a)=>e+a.qCount,0),t=e=>{const a=e.toLowerCase();return a.includes("interdit")?"ðŸš«":a.includes("silence")?"ðŸ¤«":a.includes("obligatoire")?"âš ï¸":a.includes("durÃ©e")||a.includes("heure")?"â°":a.includes("coefficient")?"ðŸ“Š":"â„¹ï¸"};return(0,u.jsxs)("section",{className:"exam-cover",style:{"--cover-accent":X},children:[(0,u.jsxs)("div",{className:"exam-cover__bg",children:[(0,u.jsx)("div",{className:"exam-cover__orb exam-cover__orb--1"}),(0,u.jsx)("div",{className:"exam-cover__orb exam-cover__orb--2"}),(0,u.jsx)("div",{className:"exam-cover__orb exam-cover__orb--3"}),(0,u.jsx)("div",{className:"exam-cover__grid"})]}),(0,u.jsxs)("div",{className:"exam-cover__inner",children:[(0,u.jsxs)("nav",{className:"exam-cover__nav",children:[(0,u.jsxs)("button",{className:"exam-cover__back",onClick:()=>s("/exams"),children:[(0,u.jsx)("svg",{width:"20",height:"20",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:"2",children:(0,u.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M15 19l-7-7 7-7"})}),"Retour"]}),(0,u.jsxs)("div",{className:"exam-cover__brand",children:[(0,u.jsx)("span",{className:"exam-cover__brand-icon",children:"ðŸŽ“"}),(0,u.jsx)("span",{children:"EdLight Academy"})]})]}),(0,u.jsxs)("div",{className:"exam-cover__hero",children:[(0,u.jsx)("div",{className:"exam-cover__badge",style:{background:X,color:"#fff"},children:Q}),(0,u.jsx)("h1",{className:"exam-cover__title",children:(0,d.Vj)(f)}),f.year&&(0,u.jsx)("p",{className:"exam-cover__year",children:f.year}),(0,u.jsxs)("div",{className:"exam-cover__stats",children:[R>0&&(0,u.jsxs)("div",{className:"exam-cover__stat",children:[(0,u.jsx)("span",{className:"exam-cover__stat-value",children:R}),(0,u.jsx)("span",{className:"exam-cover__stat-label",children:"minutes"})]}),f.total_points>0&&(0,u.jsxs)("div",{className:"exam-cover__stat",children:[(0,u.jsx)("span",{className:"exam-cover__stat-value",children:f.total_points}),(0,u.jsx)("span",{className:"exam-cover__stat-label",children:"points"})]}),(0,u.jsxs)("div",{className:"exam-cover__stat",children:[(0,u.jsx)("span",{className:"exam-cover__stat-value",children:a}),(0,u.jsx)("span",{className:"exam-cover__stat-label",children:"questions"})]}),(0,u.jsxs)("div",{className:"exam-cover__stat",children:[(0,u.jsx)("span",{className:"exam-cover__stat-value",children:e.length}),(0,u.jsx)("span",{className:"exam-cover__stat-label",children:e.length>1?"sections":"section"})]})]})]}),(0,u.jsxs)("div",{className:"exam-cover__body",children:[(0,u.jsxs)("div",{className:"exam-cover__panel exam-cover__panel--sections",children:[(0,u.jsxs)("h2",{className:"exam-cover__panel-heading",children:[(0,u.jsx)("svg",{width:"18",height:"18",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:"2",children:(0,u.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2"})}),"Structure"]}),(0,u.jsx)("ol",{className:"exam-cover__section-list",children:e.map((e,a)=>(0,u.jsxs)("li",{className:"exam-cover__section-row",children:[(0,u.jsx)("span",{className:"exam-cover__section-dot",style:{background:X}}),(0,u.jsx)("span",{className:"exam-cover__section-name",children:e.title}),(0,u.jsx)("span",{className:"exam-cover__section-qty",children:e.qCount})]},a))})]}),(null==M||null===(ee=M.rules)||void 0===ee?void 0:ee.length)>0&&(0,u.jsxs)("div",{className:"exam-cover__panel exam-cover__panel--rules",children:[(0,u.jsxs)("h2",{className:"exam-cover__panel-heading",children:[(0,u.jsx)("svg",{width:"18",height:"18",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:"2",children:(0,u.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 9v2m0 4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})}),"Consignes"]}),(0,u.jsx)("ul",{className:"exam-cover__rules-list",children:M.rules.map((e,a)=>(0,u.jsxs)("li",{className:"exam-cover__rule-item",children:[(0,u.jsx)("span",{className:"exam-cover__rule-icon",children:t(e)}),(0,u.jsx)("span",{children:e})]},a))})]})]}),(0,u.jsxs)("div",{className:"exam-cover__cta",children:[(0,u.jsxs)("button",{className:"exam-cover__start-btn",style:{background:X},onClick:()=>I(!0),children:[(0,u.jsx)("span",{children:"Commencer l'examen"}),(0,u.jsx)("svg",{width:"22",height:"22",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:"2.5",children:(0,u.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M13 7l5 5m0 0l-5 5m5-5H6"})})]}),(0,u.jsx)("p",{className:"exam-cover__cta-hint",children:"Bonne chance ! ðŸ€"})]})]})]})}const ae=k[P];if(!ae)return null;const se=S.findIndex(e=>P>=e.start&&P<=e.end),te=S[se]||{start:P,end:P,indices:[P],group:null},ne=te.indices.map(e=>x(x({},k[e]),{},{_flatIdx:e})),le=se>=S.length-1,re=se<=0,ie=((0,d._Y)(ae.type),R&&B<300),ce=(f.sections||[]).findIndex(e=>e.section_title===ae.sectionTitle),oe=null==M||null===(e=M.cleanedSections)||void 0===e?void 0:e[ce],de=null!=oe&&oe._hadRules?oe._cleanInstructions||"":ae.sectionInstructions||"";return(0,u.jsx)("section",{className:"section exam-take",children:(0,u.jsxs)("div",{className:"container",children:[(0,u.jsxs)("div",{className:"exam-take__topbar",children:[(0,u.jsxs)("div",{className:"exam-take__topbar-left",children:[(0,u.jsx)("button",{className:"button button--ghost button--sm",onClick:()=>s("/exams"),children:"â† Examens"}),(0,u.jsxs)("div",{className:"exam-take__exam-info",children:[(0,u.jsx)("span",{className:"exam-take__subject",style:{color:X},children:Q}),(0,u.jsx)("span",{className:"exam-take__title-short",children:(0,d.Vj)(f)})]})]}),(0,u.jsxs)("div",{className:"exam-take__topbar-right",children:[(0,u.jsxs)("span",{className:"exam-take__progress",children:[Z,"/",k.length]}),R>0&&(0,u.jsxs)("span",{className:"exam-take__timer ".concat(ie?"exam-take__timer--warning":""),"aria-live":"polite","aria-label":"Temps restant: ".concat(J(B)),children:[(0,u.jsx)("span",{"aria-hidden":"true",children:"â±"})," ",J(B)]}),(0,u.jsx)("button",{className:"button button--primary button--sm",onClick:()=>D(!0),children:"Soumettre"})]})]}),(0,u.jsx)("div",{className:"exam-take__progress-bar",role:"progressbar","aria-valuenow":G,"aria-valuemin":0,"aria-valuemax":100,children:(0,u.jsx)("div",{className:"exam-take__progress-fill",style:{width:"".concat(G,"%")}})}),(0,u.jsxs)("div",{className:"exam-take__body",children:[(0,u.jsxs)("aside",{className:"exam-take__nav",style:{"--nav-accent":X},children:[(0,u.jsxs)("div",{className:"exam-take__nav-progress",children:[(0,u.jsxs)("div",{className:"exam-take__nav-ring-wrap",children:[(0,u.jsxs)("svg",{className:"exam-take__nav-ring",viewBox:"0 0 48 48","aria-hidden":"true",children:[(0,u.jsx)("circle",{className:"exam-take__nav-ring-bg",cx:"24",cy:"24",r:"19"}),(0,u.jsx)("circle",{className:"exam-take__nav-ring-fill",cx:"24",cy:"24",r:"19",style:{strokeDasharray:"".concat(2*Math.PI*19),strokeDashoffset:"".concat(2*Math.PI*19*(1-G/100))}})]}),(0,u.jsxs)("span",{className:"exam-take__nav-ring-pct",children:[G,(0,u.jsx)("small",{children:"%"})]})]}),(0,u.jsxs)("div",{className:"exam-take__nav-progress-meta",children:[(0,u.jsx)("span",{className:"exam-take__nav-progress-title",children:"Progression"}),(0,u.jsxs)("span",{className:"exam-take__nav-progress-detail",children:[Z," sur ",k.length]})]})]}),(0,u.jsx)("div",{className:"exam-take__nav-divider"}),(0,u.jsx)("div",{className:"exam-take__nav-sections",role:"navigation","aria-label":"Navigation des questions par section",children:q.map(e=>{const a=P>=e.start&&P<=e.end,s=Array.from({length:e.count}).filter((a,s)=>{const t=L[e.start+s];return null!=t&&""!==t}).length,t=s===e.count;return(0,u.jsxs)("div",{className:"exam-take__nav-section ".concat(a?"exam-take__nav-section--active":""),children:[(0,u.jsxs)("div",{className:"exam-take__nav-section-title ".concat(a?"exam-take__nav-section-title--current":""),children:[(0,u.jsx)("span",{className:"exam-take__nav-section-name",children:e.title}),(0,u.jsx)("span",{className:"exam-take__nav-section-badge ".concat(t?"exam-take__nav-section-badge--done":""),children:t?"âœ“":"".concat(s,"/").concat(e.count)})]}),(0,u.jsx)("div",{className:"exam-take__nav-section-grid",children:Array.from({length:e.count}).map((a,s)=>{const t=e.start+s,n=k[t],l=null!=L[t]&&""!==L[t],r=t>=te.start&&t<=te.end;let i="exam-take__nav-btn";r?i+=" exam-take__nav-btn--current":l&&(i+=" exam-take__nav-btn--answered");const c=function(e,a){const s=e._displayNumber;if(!s)return String(a+1);if(s.length<=4)return s;const t=s.match(/^([A-Z]+)[\-.]?\s*.*?(\d+)$/i);if(t){let e=t[1];e.length>2&&(e=e.slice(0,2)+".");const a=e+t[2];return a.length<=5?a:a.slice(0,4)+"â€¦"}return s.slice(0,3)+"â€¦"}(n,t),o=S.find(e=>t>=e.start&&t<=e.end);return(0,u.jsxs)("button",{className:i,onClick:()=>z(o?o.start:t),title:"Question ".concat(h(n,t)),type:"button",children:[c,l&&!r&&(0,u.jsx)("span",{className:"exam-take__nav-btn-check","aria-hidden":"true"})]},t)})})]},"".concat(e.start,"-").concat(e.end,"-").concat(e.title))})})]}),(0,u.jsxs)("div",{className:"exam-take__content",ref:H,children:[ae.sectionTitle&&(0,u.jsx)(g,{title:ae.sectionTitle,instructions:de&&de.length<=200?de:""}),de&&de.length>200&&(0,u.jsx)(b,{text:de}),ne[0]._subExDirective&&(0,u.jsxs)("div",{className:"exam-take__subex-header",children:[(0,u.jsxs)("span",{className:"exam-take__subex-label",children:[ne[0]._subExGroup,"."]}),(0,u.jsx)("span",{className:"exam-take__subex-directive",children:(0,u.jsx)(p,{text:ne[0]._subExDirective.replace(/^[A-Z][.\-)\s]+/,"")})})]}),ne[0]._wordPool&&(0,u.jsxs)("div",{className:"exam-take__word-pool",children:[(0,u.jsx)("span",{className:"exam-take__word-pool-label",children:"Banque de mots :"})," ",(0,u.jsx)("span",{className:"exam-take__word-pool-words",children:ne[0]._wordPool})]}),ne.map(e=>{var a,s,t;const n=(0,d._Y)(e.type),l=e._flatIdx;return(0,u.jsxs)("div",{className:"card exam-take__question-card",children:[(0,u.jsxs)("div",{className:"exam-take__question-header",children:[(0,u.jsxs)("span",{className:"exam-take__question-number",children:[(0,u.jsx)("span",{className:"exam-take__question-num-label",children:h(e,l)}),1===ne.length&&(0,u.jsxs)("span",{className:"exam-take__question-num-total",children:[" / ",k.length]})]}),(0,u.jsxs)("span",{className:"exam-take__question-type",style:{background:X+"18",color:X},children:[n.icon," ",n.label]}),e.points&&(0,u.jsxs)("span",{className:"exam-take__question-points",children:[e.points," pt",1!==e.points?"s":""]})]}),e.has_figure&&e.figure_description&&(0,u.jsx)(i.A,{description:e.figure_description}),"fill_blank"===e.type&&(r=e._displayText||e.question,/_{4,}|\.{4,}/.test(r))?(0,u.jsx)("div",{className:"exam-take__question-text",children:(0,u.jsx)(N,{text:e._displayText||e.question,index:l,value:null!==(a=L[l])&&void 0!==a?a:"",onChange:W})}):(0,u.jsxs)(u.Fragment,{children:[(0,u.jsx)("div",{className:"exam-take__question-text",children:(0,u.jsx)(c.A,{text:e._displayText||e.question})}),!e.correct&&e.scaffold_text&&e.scaffold_blanks?(0,u.jsx)("div",{className:"exam-take__answer-area",children:(0,u.jsx)(C,{question:e,index:l,value:null!==(s=L[l])&&void 0!==s?s:"",onChange:W})}):(0,u.jsx)("div",{className:"exam-take__answer-area",children:(0,u.jsx)(w,{question:e,index:l,value:null!==(t=L[l])&&void 0!==t?t:"",onChange:W})})]}),!j(e)&&e.hints&&e.hints.length>0&&(0,u.jsx)(y,{hints:e.hints})]},l);var r}),ne.length>1&&(0,u.jsxs)("div",{className:"exam-take__group-counter",children:[ne[0]._subExGroup?"Groupe ".concat(ne[0]._subExGroup):"Groupe"," â€” ",ne.length," questions (",ne[0]._flatIdx+1,"â€“",ne[ne.length-1]._flatIdx+1," sur ",k.length,")"]}),(0,u.jsxs)("div",{className:"exam-take__question-nav",children:[(0,u.jsx)("button",{className:"button button--ghost",disabled:re,onClick:()=>{const e=S[se-1];e&&z(e.start)},children:"â† PrÃ©cÃ©dent"}),le?(0,u.jsx)("button",{className:"button button--primary",onClick:()=>D(!0),children:"Terminer l'examen"}):(0,u.jsx)("button",{className:"button button--primary",onClick:()=>{const e=S[se+1];e&&z(e.start)},children:"Suivant â†’"})]})]})]}),F&&(0,u.jsx)("div",{className:"exam-take__overlay",onClick:()=>D(!1),children:(0,u.jsxs)("div",{className:"exam-take__modal card",onClick:e=>e.stopPropagation(),children:[(0,u.jsx)("h3",{children:"Soumettre l'examen ?"}),(0,u.jsxs)("p",{children:["Vous avez rÃ©pondu Ã  ",(0,u.jsx)("strong",{children:Z})," sur"," ",(0,u.jsx)("strong",{children:k.length})," questions.",Z<k.length&&(0,u.jsxs)("span",{className:"exam-take__modal-warning",children:[" ","âš ï¸ ",k.length-Z," question",k.length-Z>1?"s":""," sans rÃ©ponse."]})]}),(0,u.jsxs)("div",{className:"exam-take__modal-actions",children:[(0,u.jsx)("button",{className:"button button--ghost",onClick:()=>D(!1),children:"Continuer l'examen"}),(0,u.jsx)("button",{className:"button button--primary",onClick:K,children:"Soumettre maintenant"})]})]})}),U&&de&&de.length>200&&(0,u.jsx)("div",{className:"exam-take__overlay",onClick:()=>Y(!1),children:(0,u.jsxs)("div",{className:"exam-take__passage-panel",onClick:e=>e.stopPropagation(),children:[(0,u.jsxs)("div",{className:"exam-take__passage-panel-header",children:[(0,u.jsx)("h3",{children:"ðŸ“– Texte de rÃ©fÃ©rence"}),(0,u.jsx)("button",{className:"exam-take__passage-panel-close",onClick:()=>Y(!1),type:"button",children:"âœ•"})]}),(0,u.jsx)("div",{className:"exam-take__passage-panel-body",children:(0,u.jsx)(c.A,{text:de})})]})})]})})}}}]);