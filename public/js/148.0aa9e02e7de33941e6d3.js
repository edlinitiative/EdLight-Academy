"use strict";(self.webpackChunkedlight_academy=self.webpackChunkedlight_academy||[]).push([[148],{148:(e,s,t)=>{t.r(s),t.d(s,{default:()=>f});var n=t(6540),a=t(7767),l=t(9871),r=t(1245),i=t(392),c=t(3643),o=t(7280),d=t(7791),u=t(8062),m=t(4848);function h(e){let{subjectCode:s,unitId:t,chapterNumber:a,subchapterNumber:r,courseId:h,lessonId:p,onClose:x}=e;const{data:j}=(0,l.dp)(),{user:b}=(0,u.A)(),v=null==j?void 0:j.quizBank,_=(0,n.useMemo)(()=>{if(!v||!s)return[];let e=[];if(null!=a){var n;const t="".concat(s,"|U").concat(a);e=((null===(n=v.byUnit)||void 0===n?void 0:n[t])||[]).slice()}else if(t){var l;const n="".concat(s,"|").concat(t);e=((null===(l=v.byUnit)||void 0===l?void 0:l[n])||[]).slice()}var i;0===e.length&&null!=a&&(e=((null===(i=v.bySubject)||void 0===i?void 0:i[s])||[]).slice().filter(e=>{const s=e.Chapter_Number||e.chapter_number||e.chapterNo||e.chapter||"",t=String(s).trim();if(t===String(a))return!0;const n=t.match(/^(\d+)[\.-]/);return!(!n||n[1]!==String(a))}));return null!=r&&e.length>0&&(e=e.filter(e=>{const s=e.Subchapter_Number||e.subchapter_number||e.subchapterNo||"",t=String(s).trim();return t&&t===String(r)})),(0,d.R3)(e).slice(0,10)},[v,s,t,a,r]),g=(0,n.useMemo)(()=>_.length?_.map(e=>(0,o.toDirectItemFromRow)(e)):[],[_]),[N,f]=(0,n.useState)(0),[y,S]=(0,n.useState)(0),[C,w]=(0,n.useState)(!1),[k,q]=(0,n.useState)(!1);if((0,n.useEffect)(()=>{f(0),S(0),w(!1),q(!1)},[s,t]),(0,n.useEffect)(()=>{if(k&&null!=b&&b.uid&&h&&g.length>0){const e="".concat(s,"-U").concat(a).concat(r?"-L".concat(r):""),t=y/g.length*100;(0,i.mf)(b.uid,h,e,{score:y,totalQuestions:g.length,percentage:t,timeSpent:0}).catch(e=>{console.error("[UnitQuiz] Error tracking quiz attempt:",e)}),t>=60&&p&&(0,i.jS)(b.uid,h,p).catch(e=>{console.error("[UnitQuiz] Error marking lesson complete:",e)})}},[k,null==b?void 0:b.uid,h,y,g.length,s,a,r,p]),!s)return(0,m.jsxs)("div",{className:"card",children:[(0,m.jsx)("h3",{children:"Unit Quiz"}),(0,m.jsx)("p",{className:"text-muted",children:"Choose a course and unit to start a 10-question quiz."})]});if(k)return(0,m.jsxs)("div",{className:"card",style:{padding:"1rem"},children:[(0,m.jsx)("div",{className:"quiz-card__header",style:{marginBottom:"0.5rem"},children:(0,m.jsxs)("div",{className:"quiz-card__title",children:[(0,m.jsx)("span",{className:"quiz-card__label",children:"Unit Quiz"}),(0,m.jsx)("h3",{className:"quiz-card__heading",children:"Results"})]})}),(0,m.jsxs)("p",{className:"text-muted",children:["You scored ",(0,m.jsx)("strong",{children:y})," out of ",(0,m.jsx)("strong",{children:g.length||10}),"."]}),(0,m.jsxs)("div",{className:"quiz-card__controls",children:[(0,m.jsx)("button",{className:"button button--primary button--sm",onClick:()=>{f(0),S(0),w(!1),q(!1)},children:"Retry Quiz"}),x&&(0,m.jsx)("button",{className:"button button--ghost button--sm",onClick:x,children:"Close"})]})]});if(!g.length)return(0,m.jsxs)("div",{className:"card",children:[(0,m.jsx)("h3",{children:"Unit Quiz"}),(0,m.jsxs)("p",{className:"text-muted",children:["No questions available for this chapter yet.",a&&" (Chapter ".concat(a,")")]}),!1]});const z=g[N],A="".concat(N+1," / ").concat(g.length);return(0,m.jsxs)("div",{className:"card",style:{padding:"1rem"},children:[(0,m.jsxs)("div",{className:"quiz-card__header",style:{marginBottom:"0.5rem"},children:[(0,m.jsxs)("div",{className:"quiz-card__title",children:[(0,m.jsx)("span",{className:"quiz-card__label",children:"Unit Quiz"}),(0,m.jsxs)("h3",{className:"quiz-card__heading",children:["Question ",N+1]})]}),(0,m.jsx)("span",{className:"chip chip--ghost",children:A})]}),(0,m.jsx)(c.A,{item:z,onScore:e=>{e&&("correct"!==e.message||C?"exhausted_attempts"===e.message&&w(!0):(S(e=>e+1),w(!0)))}}),(0,m.jsxs)("div",{className:"quiz-card__controls",children:[(0,m.jsx)("button",{type:"button",className:"button button--primary button--sm",onClick:()=>{if(!C)return;const e=N+1;e>=g.length?q(!0):(f(e),w(!1))},disabled:!C,children:N+1>=g.length?"Finish":"Next"}),x&&(0,m.jsx)("button",{type:"button",className:"button button--ghost button--sm",onClick:x,children:"Close"})]})]})}var p=t(4705),x=t(7016);function j(e,s){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);s&&(n=n.filter(function(s){return Object.getOwnPropertyDescriptor(e,s).enumerable})),t.push.apply(t,n)}return t}function b(e){for(var s=1;s<arguments.length;s++){var t=null!=arguments[s]?arguments[s]:{};s%2?j(Object(t),!0).forEach(function(s){(0,p.A)(e,s,t[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):j(Object(t)).forEach(function(s){Object.defineProperty(e,s,Object.getOwnPropertyDescriptor(t,s))})}return e}function v(e){let s=e;e&&"object"==typeof e&&"seconds"in e?s=1e3*e.seconds:e&&"object"==typeof e&&"toDate"in e&&(s=e.toDate().getTime());const t=Date.now()-s,n=Math.floor(t/1e3);if(n<60)return"just now";const a=Math.floor(n/60);if(a<60)return"".concat(a,"m ago");const l=Math.floor(a/60);if(l<24)return"".concat(l,"h ago");const r=Math.floor(l/24);if(1===r)return"yesterday";if(r<7)return"".concat(r,"d ago");const i=Math.floor(r/7);return i<4?"".concat(i,"w ago"):new Date(s).toLocaleDateString()}function _(e){let{threadKey:s,isAuthenticated:t,onRequireAuth:a}=e;const[l,r]=(0,n.useState)([]),[i,c]=(0,n.useState)({}),[o,d]=(0,n.useState)(""),[u,h]=(0,n.useState)({}),[p,j]=(0,n.useState)({}),[_,g]=(0,n.useState)(!0),[N,f]=(0,n.useState)(!1);return(0,n.useEffect)(()=>{if(!s)return;g(!0);const e=(0,x.kH)(s,e=>{r(e),g(!1)});return()=>{e()}},[s]),(0,n.useEffect)(()=>{const e=[];return l.forEach(s=>{const t=(0,x.IE)(s.id,e=>{c(t=>b(b({},t),{},{[s.id]:e}))});e.push(t)}),()=>{e.forEach(e=>e())}},[l]),(0,m.jsxs)("section",{className:"comments card",children:[(0,m.jsxs)("div",{className:"comments__header",children:[(0,m.jsx)("h3",{className:"section__title",style:{fontSize:"1.1rem"},children:"Questions & Discussion"}),(0,m.jsx)("p",{className:"text-muted",style:{marginTop:"0.25rem"},children:"Ask a question or share an idea about this lesson."})]}),(0,m.jsxs)("div",{className:"comments__form",children:[(0,m.jsx)("textarea",{className:"form-input",rows:3,placeholder:t?"Write a commentâ€¦":"Sign in to write a comment",value:o,onChange:e=>d(e.target.value),disabled:!t||N}),(0,m.jsx)("div",{style:{display:"flex",justifyContent:"flex-end",gap:"0.5rem"},children:t?(0,m.jsx)("button",{className:"button button--primary button--sm",type:"button",onClick:async()=>{const e=o.trim();if(!e||!t)return;const n=(0,x.HW)();if(n)try{f(!0),await(0,x.BC)(s,e,n),d("")}catch(e){console.error("Error posting comment:",e),alert("Failed to post comment. Please try again.")}finally{f(!1)}else a()},disabled:!o.trim()||N,children:N?"Postingâ€¦":"Post comment"}):(0,m.jsx)("button",{className:"button button--primary button--sm",type:"button",onClick:a,children:"Sign in to comment"})})]}),(0,m.jsx)("div",{className:"comments__list",children:_?(0,m.jsx)("div",{style:{display:"flex",justifyContent:"center",padding:"2rem"},children:(0,m.jsx)("div",{className:"loading-spinner",style:{width:"32px",height:"32px"}})}):0===l.length?(0,m.jsx)("div",{className:"text-muted",style:{fontSize:"0.9rem"},children:"No comments yet. Be the first to ask a question."}):l.map(e=>{const s=i[e.id]||[];return(0,m.jsxs)("div",{className:"comment",children:[(0,m.jsx)("div",{className:"comment__avatar","aria-hidden":!0,children:"ðŸ’¬"}),(0,m.jsxs)("div",{className:"comment__body",children:[(0,m.jsxs)("div",{className:"comment__meta",children:[(0,m.jsx)("strong",{children:e.authorName||"Student"}),(0,m.jsxs)("span",{className:"text-muted",children:["Â· ",v(e.created_at)]})]}),(0,m.jsx)("div",{className:"comment__text",children:e.text}),(0,m.jsx)("div",{className:"comment__actions",children:(0,m.jsxs)("button",{className:"button button--ghost button--sm",type:"button",onClick:()=>{if(!t)return a();j(s=>b(b({},s),{},{[e.id]:!s[e.id]}))},children:["Reply ",e.replyCount>0&&"(".concat(e.replyCount,")")]})}),s.length>0&&(0,m.jsx)("div",{className:"comment__replies",children:s.map(e=>(0,m.jsxs)("div",{className:"comment comment--reply",children:[(0,m.jsx)("div",{className:"comment__avatar","aria-hidden":!0,children:"â†³"}),(0,m.jsxs)("div",{className:"comment__body",children:[(0,m.jsxs)("div",{className:"comment__meta",children:[(0,m.jsx)("strong",{children:e.authorName||"Student"}),(0,m.jsxs)("span",{className:"text-muted",children:["Â· ",v(e.created_at)]})]}),(0,m.jsx)("div",{className:"comment__text",children:e.text})]})]},e.id))}),p[e.id]&&(0,m.jsxs)("div",{className:"comment__reply-form",children:[(0,m.jsx)("textarea",{className:"form-input",rows:2,placeholder:"Write a replyâ€¦",value:u[e.id]||"",onChange:s=>h(t=>b(b({},t),{},{[e.id]:s.target.value})),disabled:N}),(0,m.jsxs)("div",{style:{display:"flex",justifyContent:"flex-end",gap:"0.5rem"},children:[(0,m.jsx)("button",{className:"button button--ghost button--sm",type:"button",onClick:()=>j(s=>b(b({},s),{},{[e.id]:!1})),disabled:N,children:"Cancel"}),(0,m.jsx)("button",{className:"button button--primary button--sm",type:"button",onClick:()=>(async e=>{const s=(u[e]||"").trim();if(!s||!t)return;const n=(0,x.HW)();if(n)try{f(!0),await(0,x.Oe)(e,s,n),h(s=>b(b({},s),{},{[e]:""})),j(s=>b(b({},s),{},{[e]:!1}))}catch(e){console.error("Error posting reply:",e),alert("Failed to post reply. Please try again.")}finally{f(!1)}else a()})(e.id),disabled:!t||!(u[e.id]||"").trim()||N,children:N?"Postingâ€¦":"Post reply"})]})]})]})]},e.id)})})]})}function g(e){let{subjectCode:s,chapterNumber:t,subchapterNumber:a,onClose:r}=e;const{data:i}=(0,l.dp)(),c=null==i?void 0:i.quizBank,o=(0,d.n7)(),[u,h]=(0,n.useState)(0),[p,x]=(0,n.useState)(!1),[j,b]=(0,n.useState)(new Set),[v,_]=(0,n.useState)(new Set),g=(0,n.useMemo)(()=>{if(!c||!s)return[];let e=[];if(null!=t){var n;const a="".concat(s,"|U").concat(t);e=((null===(n=c.byUnit)||void 0===n?void 0:n[a])||[]).slice(),0===e.length&&c.bySubject&&(e=(c.bySubject[s]||[]).slice().filter(e=>{const s=e.Chapter_Number||e.chapter_number||e.unit;return String(s)===String(t)}))}return null!=a&&e.length>0&&(e=e.filter(e=>{const s=e.Subchapter_Number||e.subchapter_number||e.lesson_no;return String(s)===String(a)})),e.map((e,s)=>{let t=[];if("string"==typeof e.options)try{t=JSON.parse(e.options)}catch(s){t=[e.option_a,e.option_b,e.option_c,e.option_d].filter(Boolean)}else t=Array.isArray(e.options)?e.options:[e.option_a,e.option_b,e.option_c,e.option_d].filter(Boolean);const n=t[(e.correct_answer||e.correctAnswer||"A").charCodeAt(0)-65]||t[0]||"No answer available";return{id:e.id||e.quiz_id||s,question:e.question,answer:n,hint:e.hint,explanation:e.good_response||e.wrong_response,allOptions:t}})},[c,s,t,a]),[N,f]=(0,n.useState)(null),y=N||g;if(!y||0===y.length)return(0,m.jsxs)("div",{className:"flashcard-deck",children:[(0,m.jsxs)("div",{className:"flashcard-deck__header",children:[(0,m.jsx)("h3",{children:"Flashcards"}),(0,m.jsx)("button",{className:"button button--ghost button--sm",onClick:r,children:"Close"})]}),(0,m.jsx)("div",{className:"flashcard-empty",children:(0,m.jsx)("p",{className:"text-muted",children:"No flashcards available for this section."})})]});const S=y[u],C=u+1,w=y.length,k=j.has(S.id),q=v.has(S.id);return(0,m.jsxs)("div",{className:"flashcard-deck",children:[(0,m.jsxs)("div",{className:"flashcard-deck__header",children:[(0,m.jsxs)("div",{children:[(0,m.jsx)("h3",{children:"Flashcards"}),(0,m.jsxs)("p",{className:"text-muted",children:["Card ",C," of ",w," â€¢ ",j.size," mastered â€¢ ",v.size," to review"]})]}),(0,m.jsxs)("div",{className:"flashcard-deck__actions",children:[(0,m.jsx)("button",{className:"button button--ghost button--sm",onClick:()=>{f((0,d.R3)(y)),h(0),x(!1)},title:"Shuffle cards",children:"ðŸ”€ Shuffle"}),(0,m.jsx)("button",{className:"button button--ghost button--sm",onClick:r,children:"Close"})]})]}),(0,m.jsxs)("div",{className:"flashcard-container",children:[(0,m.jsx)("div",{className:"flashcard ".concat(p?"flashcard--flipped":""," ").concat(k?"flashcard--mastered":""," ").concat(q?"flashcard--difficult":""),onClick:()=>{x(!p)},children:(0,m.jsxs)("div",{className:"flashcard__inner",children:[(0,m.jsxs)("div",{className:"flashcard__front",children:[(0,m.jsx)("div",{className:"flashcard__label",children:"Question"}),(0,m.jsx)("div",{className:"flashcard__content",dangerouslySetInnerHTML:(0,d.qZ)(S.question,o)}),(0,m.jsx)("div",{className:"flashcard__hint-text",children:"ðŸ’¡ Click to reveal answer"})]}),(0,m.jsxs)("div",{className:"flashcard__back",children:[(0,m.jsx)("div",{className:"flashcard__label",children:"Answer"}),(0,m.jsx)("div",{className:"flashcard__content flashcard__content--answer",dangerouslySetInnerHTML:(0,d.qZ)(S.answer,o)}),S.hint&&(0,m.jsxs)("div",{className:"flashcard__hint",children:[(0,m.jsx)("strong",{children:"Hint:"})," ",(0,m.jsx)("span",{dangerouslySetInnerHTML:(0,d.qZ)(S.hint,o)})]}),S.explanation&&(0,m.jsxs)("div",{className:"flashcard__explanation",children:[(0,m.jsx)("strong",{children:"Explanation:"})," ",(0,m.jsx)("span",{dangerouslySetInnerHTML:(0,d.qZ)(S.explanation,o)})]})]})]})}),(0,m.jsxs)("div",{className:"flashcard-controls",children:[(0,m.jsx)("button",{className:"button button--ghost",onClick:()=>{u>0&&(h(u-1),x(!1))},disabled:0===u,children:"â† Previous"}),(0,m.jsxs)("div",{className:"flashcard-controls__rating",children:[(0,m.jsx)("button",{className:"button button--sm ".concat(q?"button--danger":"button--ghost"),onClick:()=>{_(e=>{const s=new Set(e);return s.add(S.id),s}),b(e=>{const s=new Set(e);return s.delete(S.id),s})},title:"Mark as difficult to review later",children:"ðŸ˜• Hard"}),(0,m.jsx)("button",{className:"button button--sm ".concat(k?"button--success":"button--ghost"),onClick:()=>{b(e=>{const s=new Set(e);return s.add(S.id),s}),_(e=>{const s=new Set(e);return s.delete(S.id),s})},title:"Mark as mastered",children:"âœ“ Got it!"})]}),(0,m.jsx)("button",{className:"button button--ghost",onClick:()=>{u<y.length-1&&(h(u+1),x(!1))},disabled:u===y.length-1,children:"Next â†’"})]}),(0,m.jsx)("div",{className:"flashcard-progress",children:(0,m.jsx)("div",{className:"flashcard-progress__bar",style:{width:"".concat(C/w*100,"%")}})})]})]})}function N(e){let{videoId:s,title:t,onTimeUpdate:a,onEnded:l}=e;const r=(0,n.useRef)(null),i=(0,n.useRef)(null),c=(0,n.useRef)(null);(0,n.useEffect)(()=>{if(window.YT)o();else{const e=document.createElement("script");e.src="https://www.youtube.com/iframe_api";const s=document.getElementsByTagName("script")[0];s.parentNode.insertBefore(e,s),window.onYouTubeIframeAPIReady=()=>{o()}}return()=>{if(c.current&&(clearInterval(c.current),c.current=null),r.current){try{r.current.destroy()}catch(e){}r.current=null}}},[s]);const o=()=>{s&&i.current&&new window.YT.Player(i.current,{videoId:s,playerVars:{autoplay:0,rel:0,modestbranding:1,iv_load_policy:3,fs:1,playsinline:1,enablejsapi:1},events:{onReady:e=>{r.current=e.target,d(e.target)},onStateChange:e=>{e.data===window.YT.PlayerState.ENDED&&l&&l(),e.data,window.YT.PlayerState.PAUSED}}})},d=e=>{c.current&&clearInterval(c.current),c.current=setInterval(()=>{if(e&&"function"==typeof e.getCurrentTime){const t=e.getCurrentTime(),n=e.getDuration();var s;a&&t&&n&&a({currentTime:t,duration:n,playbackRate:(null===(s=e.getPlaybackRate)||void 0===s?void 0:s.call(e))||1})}},1e3)};return(0,m.jsx)("div",{style:{position:"relative",width:"100%",height:"100%"},children:(0,m.jsx)("div",{ref:i,style:{width:"100%",height:"100%"}})})}function f(){var e,s,t,c,o,d,p,x,j,b,v,f;const{courseId:y}=(0,a.g)(),S=(0,a.Zp)(),{data:C,isLoading:w}=(0,l.dp)(),[k,q]=(0,n.useState)(0),[z,A]=(0,n.useState)(0),[E,T]=(0,n.useState)(!1),[I,P]=(0,n.useState)(!1),[M,D]=(0,n.useState)(()=>new Set([0])),[L,O]=(0,n.useState)(!1),[U,H]=(0,n.useState)(!1),{isAuthenticated:R,enrolledCourses:B,user:Z}=(0,u.A)(),{progress:F}=(0,r.up)(y),Q=null==C||null===(e=C.courses)||void 0===e?void 0:e.find(e=>e.id===y),Y=B.some(e=>e.id===y),W=null!==(s=null==Q?void 0:Q.modules)&&void 0!==s?s:[],K=null!==(t=W[k])&&void 0!==t?t:null,V=Array.isArray(null==K?void 0:K.lessons)?K.lessons:[],G=null!==(c=V[z])&&void 0!==c?c:null,J=null!==(o=null!==(d=null!==(p=null!==(x=null!==(j=null==G?void 0:G.objectives)&&void 0!==j?j:null==G?void 0:G.description)&&void 0!==x?x:null==K?void 0:K.description)&&void 0!==p?p:null==K?void 0:K.objective)&&void 0!==d?d:null==Q?void 0:Q.description)&&void 0!==o?o:"",X=(null==G?void 0:G.videoUrl)||(null==K?void 0:K.videoUrl)||(null==V||null===(b=V[0])||void 0===b?void 0:b.videoUrl)||(null==Q?void 0:Q.trailerUrl)||"",$=X&&(X.includes("youtube.com")||X.includes("youtu.be"))?function(e){if(!e)return null;try{const t=new URL(e);if(t.hostname.includes("youtube.com"))return t.searchParams.get("v");if(t.hostname.includes("youtu.be"))return t.pathname.slice(1);var s;if(t.pathname.includes("/embed/"))return null===(s=t.pathname.split("/embed/")[1])||void 0===s?void 0:s.split("?")[0]}catch(e){return null}return null}(X):null,ee=X,se="comments:".concat(y,":").concat((null==G?void 0:G.id)||(null==K?void 0:K.id)||"module"),te=e=>{var s;return Array.isArray(null===(s=W[e])||void 0===s?void 0:s.lessons)?W[e].lessons:[]},ne=((e,s)=>{if(te(e).length>0&&s>0)return{module:e,lesson:s-1};for(let s=e-1;s>=0;s--){const e=te(s);if(e.length>0)return{module:s,lesson:e.length-1}}return null})(k,z),ae=((e,s)=>{const t=te(e);if(t.length>0&&s<t.length-1)return{module:e,lesson:s+1};for(let s=e+1;s<W.length;s++)if(te(s).length>0)return{module:s,lesson:0};return null})(k,z),le=(0,u.A)(e=>e.hydrated);(0,n.useEffect)(()=>{le&&!R&&u.A.getState().toggleAuthModal()},[le,R]),(0,n.useEffect)(()=>{q(0),A(0),D(new Set([0]))},[y]),(0,n.useEffect)(()=>{W.length>0&&k>=W.length&&q(0)},[W.length,k]),(0,n.useEffect)(()=>{A(0),T(!1),D(e=>{const s=new Set(e);return s.add(k),s})},[k]),(0,n.useEffect)(()=>{T(!1)},[z]);const re=(null==F||null===(v=F.completedLessons)||void 0===v?void 0:v.includes(null==G?void 0:G.id))||!1;return(0,n.useEffect)(()=>{if(null!=Z&&Z.uid&&Y&&G&&"video"===G.type&&!$){const e=setTimeout(()=>{(0,i.eE)(Z.uid,y,G.id,{watchDuration:10,totalDuration:60*G.duration||600,completed:!1})},1e4);return()=>clearTimeout(e)}},[G,Z,Y,$]),w?(0,m.jsx)("div",{className:"section",children:(0,m.jsx)("div",{className:"container",children:(0,m.jsx)("div",{className:"card card--centered card--loading",children:(0,m.jsx)("div",{className:"loading-spinner"})})})}):Q?(0,m.jsx)("div",{className:"section",children:(0,m.jsx)("div",{className:"container",children:(0,m.jsxs)("div",{className:"course-detail__layout",children:[(0,m.jsxs)("div",{className:"course-detail__column",children:[(0,m.jsxs)("article",{className:"lesson-card",children:[(0,m.jsxs)("header",{className:"lesson-card__header",children:[(0,m.jsxs)("div",{className:"lesson-card__header-content",children:[(0,m.jsx)("h1",{className:"lesson-card__title",children:(null==G?void 0:G.title)||(null==K?void 0:K.title)||Q.name}),Y&&F&&(0,m.jsxs)("div",{className:"lesson-card__progress-badges lesson-card__progress-badges--desktop",children:[F.totalPoints>0&&(0,m.jsxs)("span",{className:"chip chip--primary",children:["ðŸŽ¯ ",F.totalPoints," pts"]}),F.currentStreak>0&&(0,m.jsxs)("span",{className:"chip chip--warning",children:["ðŸ”¥ ",F.currentStreak," day streak"]}),(null===(f=F.completedLessons)||void 0===f?void 0:f.length)>0&&(0,m.jsxs)("span",{className:"chip chip--success",children:["âœ“ ",F.completedLessons.length," completed"]})]})]}),(0,m.jsx)("button",{className:"button button--ghost button--sm lesson-card__sidebar-toggle",onClick:()=>O(!L),type:"button",children:L?"âœ• Close":"ðŸ“š Course Content"})]}),(0,m.jsx)("div",{className:"lesson-card__media ".concat("quiz"===(null==G?void 0:G.type)?"lesson-card__media--quiz":""),children:"quiz"===(null==G?void 0:G.type)?(0,m.jsx)("div",{className:"lesson-card__quizwrap",children:(0,m.jsx)(h,{subjectCode:null==Q?void 0:Q.code,chapterNumber:null==K?void 0:K.unit_no,courseId:y,lessonId:null==G?void 0:G.id})}):ee?$?(0,m.jsx)(N,{videoId:$,title:(null==G?void 0:G.title)||(null==K?void 0:K.title)||Q.name,onTimeUpdate:e=>{let{currentTime:s,duration:t}=e;null!=Z&&Z.uid&&Y&&G&&s>=10&&(0,i.eE)(Z.uid,y,G.id,{watchDuration:s,totalDuration:t,completed:s>=.9*t})},onEnded:()=>{null!=Z&&Z.uid&&Y&&G&&(0,i.eE)(Z.uid,y,G.id,{watchDuration:60*G.duration||600,totalDuration:60*G.duration||600,completed:!0})}},$):(0,m.jsx)("iframe",{src:ee,title:(null==G?void 0:G.title)||(null==K?void 0:K.title)||Q.name,allow:"accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture",allowFullScreen:!0},ee):(0,m.jsx)("div",{className:"lesson-card__placeholder",children:"Video content will appear here once available."})}),J&&(0,m.jsx)("p",{className:"lesson-card__description text-muted",children:J}),(0,m.jsxs)("div",{className:"lesson-card__nav",children:[(ne||ae)&&(0,m.jsxs)("div",{className:"lesson-card__nav-group lesson-card__nav-group--navigation",children:[(0,m.jsx)("button",{className:"button button--ghost button--sm",onClick:()=>{ne&&(q(ne.module),A(ne.lesson),O(!1))},disabled:!ne,children:"â† Previous"}),(0,m.jsx)("button",{className:"button button--ghost button--sm",onClick:()=>{ae&&(q(ae.module),A(ae.lesson),O(!1))},disabled:!ae,children:"Next â†’"})]}),(0,m.jsxs)("div",{className:"lesson-card__nav-group lesson-card__nav-group--actions",children:["quiz"!==(null==G?void 0:G.type)&&Y&&(0,m.jsx)("button",{className:"button button--sm ".concat(re?"button--success":"button--secondary"),onClick:async()=>{if(null!=Z&&Z.uid&&y&&null!=G&&G.id)try{await(0,i.jS)(Z.uid,y,G.id)}catch(e){console.error("[CourseDetail] Error marking lesson complete:",e)}},disabled:re,children:re?"âœ“ Completed":"Mark Complete"}),(0,m.jsxs)(m.Fragment,{children:[(0,m.jsxs)("button",{className:"button button--ghost button--sm",onClick:()=>P(!0),title:"Study with flashcards",children:[(0,m.jsx)("span",{className:"button-icon",children:"ðŸ“‡"}),(0,m.jsx)("span",{className:"button-text",children:"Flashcards"})]}),(0,m.jsxs)("button",{className:"button button--primary button--sm",onClick:()=>T(!0),title:"Practice with quiz",children:[(0,m.jsx)("span",{className:"button-icon",children:"ðŸ“"}),(0,m.jsx)("span",{className:"button-text",children:"Practice"})]})]})]})]})]}),E&&(0,m.jsx)(m.Fragment,{children:(0,m.jsx)(h,{subjectCode:null==Q?void 0:Q.code,chapterNumber:null==K?void 0:K.unit_no,subchapterNumber:null==G?void 0:G.lesson_no,courseId:y,onClose:()=>T(!1)})}),I&&(0,m.jsx)(g,{subjectCode:null==Q?void 0:Q.code,chapterNumber:null==K?void 0:K.unit_no,subchapterNumber:null==G?void 0:G.lesson_no,onClose:()=>P(!1)}),(0,m.jsxs)("div",{className:"lesson-card lesson-card--comments ".concat(U?"lesson-card--comments-open":""),children:[(0,m.jsxs)("button",{className:"lesson-card__comments-toggle",onClick:()=>H(!U),type:"button",children:[(0,m.jsx)("span",{className:"lesson-card__comments-title",children:"ðŸ’¬ Discussion & Comments"}),(0,m.jsx)("span",{className:"lesson-card__comments-chevron",children:U?"â–¼":"â–¶"})]}),(0,m.jsx)("div",{className:"lesson-card__comments-content",children:(0,m.jsx)(_,{threadKey:se,isAuthenticated:R,onRequireAuth:()=>u.A.getState().toggleAuthModal()})})]})]}),(0,m.jsxs)("aside",{className:"lesson-sidebar ".concat(L?"lesson-sidebar--visible":""),children:[(0,m.jsxs)("div",{className:"lesson-sidebar__header",children:[(0,m.jsxs)("div",{children:[(0,m.jsx)("h3",{className:"lesson-sidebar__heading",children:"Course Content"}),(0,m.jsx)("p",{className:"text-muted lesson-sidebar__description",children:Y?"Track your progress across each module and revisit lessons anytime.":"Preview the modules covered in this course. Enroll to unlock full lessons."})]}),(0,m.jsx)("button",{className:"lesson-sidebar__close",onClick:()=>O(!1),type:"button","aria-label":"Close sidebar",children:"âœ•"})]}),(0,m.jsx)("div",{className:"lesson-list",children:W.length>0?W.map((e,s)=>{var t,n;const a=s===k,l=Array.isArray(e.lessons)&&e.lessons.length>0,r=M.has(s);return(0,m.jsxs)("div",{className:"lesson-list__group",children:[(0,m.jsxs)("button",{className:"lesson-list__item ".concat(a?"lesson-list__item--active":""," ").concat(r?"is-expanded":""),onClick:()=>{a?D(e=>{const t=new Set(e);return t.has(s)?t.delete(s):t.add(s),t}):(q(s),A(0),D(e=>{const t=new Set(e);return t.add(s),t}))},type:"button",children:[(0,m.jsx)("span",{className:"lesson-list__index",children:String(s+1).padStart(2,"0")}),(0,m.jsxs)("span",{className:"lesson-list__meta",children:[(0,m.jsx)("span",{className:"lesson-list__title",children:e.title}),(0,m.jsx)("span",{className:"lesson-list__duration",children:e.duration?"".concat(e.duration," min"):e.readingTime?"".concat(e.readingTime," min read"):null!==(n=e.lessons)&&void 0!==n&&n.length?"".concat(e.lessons.length," lesson").concat(1===e.lessons.length?"":"s"):"Coming soon"})]}),(0,m.jsx)("span",{className:"lesson-list__chevron","aria-hidden":!0,children:"â–¸"}),a&&(0,m.jsx)("span",{className:"chip chip--ghost",children:"Current"})]}),r&&l&&(0,m.jsx)("div",{className:"lesson-list__children",children:e.lessons.map((e,t)=>{var n,l;const r=a&&t===z,i=(null==F||null===(n=F.completedLessons)||void 0===n?void 0:n.includes(e.id))||!1;return(0,m.jsxs)("button",{type:"button",className:"lesson-list__item ".concat(r?"lesson-list__item--active":""," ").concat(i?"lesson-list__item--completed":""),onClick:()=>{q(s),A(t),O(!1)},children:[(0,m.jsx)("span",{className:"lesson-list__index",children:i?"âœ“":"".concat(s+1,".").concat(t+1)}),(0,m.jsxs)("span",{className:"lesson-list__meta",children:[(0,m.jsx)("span",{className:"lesson-list__title",children:e.title}),(0,m.jsx)("span",{className:"lesson-list__duration",children:e.duration?"".concat(e.duration," min"):e.readingTime?"".concat(e.readingTime," min read"):""})]}),r&&(0,m.jsx)("span",{className:"chip chip--ghost",children:"Current"})]},null!==(l=e.id)&&void 0!==l?l:"".concat(s,"-").concat(t))})})]},null!==(t=e.id)&&void 0!==t?t:s)}):(0,m.jsx)("div",{className:"lesson-list__empty",children:"Modules for this course will appear here shortly."})})]})]})})}):(0,m.jsx)("div",{className:"section",children:(0,m.jsx)("div",{className:"container",children:(0,m.jsxs)("div",{className:"card card--message",children:[(0,m.jsx)("h2",{className:"section__title",children:"This course is not available"}),(0,m.jsx)("p",{className:"text-muted",children:"We couldn't find the course you were looking for."}),(0,m.jsx)("button",{className:"button button--primary button--pill",onClick:()=>S("/courses"),children:"Return to Course List"})]})})})}},3643:(e,s,t)=>{t.d(s,{A:()=>r});var n=t(6540),a=t(7791),l=t(4848);function r(e){let{item:s,onScore:t}=e;const r=(0,a.n7)(),[i,c]=(0,n.useState)(null),[o,d]=(0,n.useState)(""),[u,m]=(0,n.useState)(!1),[h,p]=(0,n.useState)(null),[x,j]=(0,n.useState)(0);(0,n.useEffect)(()=>{c(null),d(""),m(!1),p(null),j(0)},[s]);const b=()=>{if(!u){const e=3-x;return(0,l.jsxs)("span",{className:"chip chip--ghost",children:[e," ",1===e?"try":"tries"," left"]})}return h?(0,l.jsx)("span",{className:"chip chip--success",children:"âœ“ Correct"}):(0,l.jsx)("span",{className:"chip chip--danger",children:"Out of tries"})},v=!u&&x>0&&Array.isArray(s.hints)?s.hints[Math.min(x-1,s.hints.length-1)]:"",_=(0,n.useMemo)(()=>{var e;return"mcq"===s.kind||"tf"===s.kind?null!==(e=s.correctLabel)&&void 0!==e?e:Array.isArray(s.options)?s.options[s.correctIndex]:"":s.correctText||""},[s]);return(0,l.jsxs)("div",{className:"card",style:{padding:"1rem"},children:[(0,l.jsxs)("div",{className:"quiz-card__header",style:{marginBottom:"0.5rem"},children:[(0,l.jsx)("div",{className:"quiz-card__title",children:(0,l.jsx)("span",{className:"quiz-card__label",children:"Curriculum Practice"})}),(0,l.jsx)(b,{})]}),(0,l.jsx)("div",{className:"quiz-card__question",dangerouslySetInnerHTML:(0,a.qZ)(s.stem,r)}),"mcq"===s.kind||"tf"===s.kind?(0,l.jsx)("div",{className:"quiz-card__options",children:s.options.map((e,s)=>(0,l.jsxs)("label",{className:"radio-option",children:[(0,l.jsx)("input",{type:"radio",name:"bank-answer",value:s,checked:i===s,onChange:()=>c(s),disabled:u}),(0,l.jsx)("span",{dangerouslySetInnerHTML:(0,a.qZ)(e,r)})]},s))}):(0,l.jsx)("input",{type:"text",className:"input-field",placeholder:"Enter your answer",value:o,onChange:e=>d(e.target.value),disabled:u}),v&&(0,l.jsxs)("div",{className:"hint-box",style:{margin:"0.5rem 0"},children:[(0,l.jsx)("strong",{children:"Hint:"})," ",(0,l.jsx)("span",{dangerouslySetInnerHTML:(0,a.qZ)(v,r)})]}),(0,l.jsx)("div",{className:"quiz-card__controls",children:(0,l.jsx)("button",{type:"button",className:"button button--primary button--sm",onClick:()=>{let e=!1;if("mcq"===s.kind||"tf"===s.kind){if(null===i)return;e=i===s.correctIndex}else{const t=e=>String(e||"").trim().toLowerCase();e=t(o)===t(s.correctText)}if(e)return m(!0),p(!0),void(t&&t({correct:1,message:"correct"}));const n=x+1;j(n),n>=3?(m(!0),p(!1),t&&t({correct:0,message:"exhausted_attempts"})):(p(!1),t&&t({correct:0,message:"attempt_".concat(n)}))},disabled:u||("mcq"===s.kind||"tf"===s.kind?null===i:0===o.trim().length),children:u?"Answered":x>0?"Try Again":"Check Answer"})}),u&&(0,l.jsx)("div",{className:"quiz-card__explanation",style:{marginTop:"0.75rem"},children:h?(0,l.jsxs)("div",{children:[(0,l.jsxs)("div",{style:{marginBottom:"0.5rem"},children:[(0,l.jsx)("strong",{children:"Correct!"})," ",_?(0,l.jsxs)(l.Fragment,{children:[" ",(0,l.jsx)("em",{children:"Answer:"})," ",(0,l.jsx)("span",{dangerouslySetInnerHTML:(0,a.qZ)(_,r)})]}):null]}),s.good&&(0,l.jsxs)("div",{children:[(0,l.jsx)("strong",{children:"Explanation:"})," ",(0,l.jsx)("span",{dangerouslySetInnerHTML:(0,a.qZ)(s.good,r)})]})]}):(0,l.jsxs)("div",{children:[(0,l.jsxs)("div",{style:{marginBottom:"0.5rem"},children:[(0,l.jsx)("strong",{children:"Correct answer:"})," ",(0,l.jsx)("span",{dangerouslySetInnerHTML:(0,a.qZ)(_,r)})]}),(s.good||s.wrong)&&(0,l.jsxs)("div",{children:[(0,l.jsx)("strong",{children:"Explanation:"})," ",(0,l.jsx)("span",{dangerouslySetInnerHTML:(0,a.qZ)(s.good||s.wrong,r)})]})]})})]})}}}]);