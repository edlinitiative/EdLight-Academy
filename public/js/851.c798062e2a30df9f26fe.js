"use strict";(self.webpackChunkedlight_academy=self.webpackChunkedlight_academy||[]).push([[851],{392:(t,e,r)=>{r.d(e,{wk:()=>w,Hb:()=>g,jS:()=>l,mf:()=>d,eE:()=>u});var n=r(4705),a=r(7016),s=r(4589);async function o(t,e){try{const r="notif-".concat(Date.now()),n={7:"ðŸ”¥ Amazing! You have a 7-day study streak!",30:"âš¡ Incredible! 30 days of consistent learning!",100:"ðŸ‘‘ Legendary! 100-day study streak achieved!"}[e]||"ðŸ”¥ You're on a ".concat(e,"-day streak!");return await(0,s.BN)((0,s.H9)(a.db,"users",t,"notifications",r),{id:r,type:"streak",title:"Streak Milestone!",message:n,streakDays:e,read:!1,createdAt:(0,s.O5)()}),r}catch(t){return console.error("Error creating streak notification:",t),null}}function i(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})),r.push.apply(r,n)}return r}function c(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?i(Object(r),!0).forEach(function(e){(0,n.A)(t,e,r[e])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):i(Object(r)).forEach(function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))})}return t}async function u(t,e,r,n){if(t)try{const i=(0,s.H9)(a.db,"users",t,"progress",e),u=await(0,s.x7)(i),l=new Date,d=u.exists()?u.data():null,f=d&&d.watchedVideos||{},g=null==d?void 0:d.lastStudyDate;f[r]={watchedAt:l,watchDuration:n.watchDuration||0,totalDuration:n.totalDuration||0,completed:n.completed||!1};const w={watchedVideos:f,lastAccessedAt:l,lastStudyDate:l};u.exists()?await(0,s.mZ)(i,w):await(0,s.BN)(i,c(c({courseId:e,enrolledAt:l},w),{},{completedLessons:[],quizAttempts:{},totalPoints:0,badges:[],currentStreak:1,longestStreak:1})),await async function(t,e,r){try{const n=(0,s.H9)(a.db,"users",t,"progress",e),i=await(0,s.x7)(n);if(!i.exists())return;const c=i.data(),u=null!=r&&r.toDate?r.toDate():r instanceof Date?r:null,l=new Date;if(!u)return void await(0,s.mZ)(n,{currentStreak:1,longestStreak:1});const d=Math.abs(l-u),f=Math.floor(d/864e5);let g=c.currentStreak||1,w=c.longestStreak||1;if(0===f)return;1===f?(g+=1,w=Math.max(w,g)):g=1,await(0,s.mZ)(n,{currentStreak:g,longestStreak:w}),7===g&&(await p(t,e,"week_streak"),await o(t,7)),30===g&&(await p(t,e,"month_streak"),await o(t,30)),100===g&&(await p(t,e,"legend_streak"),await o(t,100))}catch(t){console.error("[Progress] Error updating streak:",t)}}(t,e,g)}catch(t){console.error("[Progress] Error tracking video:",t)}}async function l(t,e,r){if(t)try{const n=(0,s.H9)(a.db,"users",t,"progress",e),o=await(0,s.x7)(n);if(!o.exists())return void console.warn("[Progress] No progress document found");const i=o.data().completedLessons||[];i.includes(r)||(i.push(r),await(0,s.mZ)(n,{completedLessons:i,lastAccessedAt:new Date}),await f(t,e,10))}catch(t){console.error("[Progress] Error marking lesson complete:",t)}}async function d(t,e,r,n){if(t)try{const o=(0,s.H9)(a.db,"users",t,"progress",e),i=await(0,s.x7)(o),c=i.exists()&&i.data().quizAttempts||{};c[r]||(c[r]={attempts:[]}),c[r].attempts.push({attemptedAt:new Date,score:n.score,totalQuestions:n.totalQuestions,timeSpent:n.timeSpent||0}),await(0,s.mZ)(o,{quizAttempts:c,lastAccessedAt:new Date,lastStudyDate:new Date});const u=n.score/n.totalQuestions*100;let l=0;l=u>=90?50:u>=80?40:u>=70?30:u>=60?20:10,await f(t,e,l),await async function(t,e){try{const r=(0,s.H9)(a.db,"users",t,"progress",e),n=await(0,s.x7)(r);if(!n.exists())return;const o=n.data(),i=o.quizAttempts||{},c=o.totalPoints||0;let u=0,l=0;Object.values(i).forEach(t=>{u+=t.attempts.length,t.attempts.forEach(t=>{t.score===t.totalQuestions&&l++})}),u>=10&&await p(t,e,"quiz_enthusiast"),u>=50&&await p(t,e,"quiz_master"),l>=5&&await p(t,e,"perfectionist"),c>=1e3&&await p(t,e,"point_collector"),c>=5e3&&await p(t,e,"point_master")}catch(t){console.error("[Progress] Error checking achievements:",t)}}(t,e)}catch(t){console.error("[Progress] Error tracking quiz attempt:",t)}}async function f(t,e,r,n){if(t)try{const n=(0,s.H9)(a.db,"users",t,"progress",e),o=await(0,s.x7)(n);if(!o.exists())return;const i=o.data().totalPoints||0;await(0,s.mZ)(n,{totalPoints:i+r})}catch(t){console.error("[Progress] Error awarding points:",t)}}async function p(t,e,r){if(t)try{const n=(0,s.H9)(a.db,"users",t,"progress",e),o=await(0,s.x7)(n);if(!o.exists())return;const i=o.data().badges||[];if(!i.includes(r)){i.push(r),await(0,s.mZ)(n,{badges:i});const e={first_lesson:{name:"First Lesson",icon:"ðŸŽ“"},quiz_enthusiast:{name:"Quiz Enthusiast",icon:"ðŸ“"},perfectionist:{name:"Perfectionist",icon:"ðŸ’¯"},point_collector:{name:"Point Collector",icon:"ðŸ’Ž"},week_streak:{name:"7 Day Streak",icon:"ðŸ”¥"},month_streak:{name:"30 Day Streak",icon:"âš¡"},legend_streak:{name:"100 Day Streak",icon:"ðŸ‘‘"}}[r]||{name:r,icon:"ðŸ…"};await async function(t,e){try{const r="notif-".concat(Date.now());return await(0,s.BN)((0,s.H9)(a.db,"users",t,"notifications",r),{id:r,type:"achievement",title:"New Achievement! ðŸŽ‰",message:"You've earned the \"".concat(e.name,'" badge!'),badgeId:e.badgeId,icon:e.icon,read:!1,createdAt:(0,s.O5)()}),r}catch(t){return console.error("Error creating achievement notification:",t),null}}(t,c({badgeId:r},e))}}catch(t){console.error("[Progress] Error awarding badge:",t)}}async function g(t,e){if(!t)return null;try{const r=(0,s.H9)(a.db,"users",t,"progress",e),n=await(0,s.x7)(r);return n.exists()?n.data():null}catch(t){return console.error("[Progress] Error getting course progress:",t),null}}async function w(t){if(!t)return[];try{const e=(0,s.rJ)(a.db,"users",t,"progress"),r=await(0,s.GG)(e),n=[];return r.forEach(t=>{n.push(c({courseId:t.id},t.data()))}),n}catch(t){return console.error("[Progress] Error getting all user progress:",t),[]}}},1245:(t,e,r)=>{r.d(e,{sL:()=>i,up:()=>o});var n=r(6540),a=r(392),s=r(8062);function o(t){const[e,r]=(0,n.useState)(null),[o,i]=(0,n.useState)(!0),{user:c}=(0,s.A)();return(0,n.useEffect)(()=>{if(null==c||!c.uid||!t)return r(null),void i(!1);(async()=>{i(!0);const e=await(0,a.Hb)(c.uid,t);r(e),i(!1)})()},[null==c?void 0:c.uid,t]),{progress:e,loading:o}}function i(){const[t,e]=(0,n.useState)([]),[r,o]=(0,n.useState)(!0),{user:i}=(0,s.A)();return(0,n.useEffect)(()=>{if(null==i||!i.uid)return e([]),void o(!1);(async()=>{o(!0);const t=await(0,a.wk)(i.uid);e(t),o(!1)})()},[null==i?void 0:i.uid]),{progress:t,loading:r}}},7791:(t,e,r)=>{r.d(e,{O4:()=>c,R3:()=>u,n7:()=>o,qZ:()=>i});var n=r(6540);const a="https://unpkg.com/katex@0.16.9/dist/katex.min.css",s="https://unpkg.com/katex@0.16.9/dist/katex.min.js";function o(){const[t,e]=(0,n.useState)("undefined"!=typeof window&&!!window.katex);return(0,n.useEffect)(()=>{t||(function(t){if(document.querySelector('link[href="'.concat(t,'"]')))return;const e=document.createElement("link");e.rel="stylesheet",e.href=t,document.head.appendChild(e)}(a),function(t,e){if(document.querySelector('script[src="'.concat(t,'"]')))return void(e&&e());const r=document.createElement("script");r.src=t,r.async=!0,r.onload=e||null,document.body.appendChild(r)}(s,()=>e(!0)))},[t]),t}function i(t,e){if(!t)return{__html:""};let r=String(t);return e&&"undefined"!=typeof window&&window.katex?(r=r.replace(/\$\$([\s\S]+?)\$\$/g,(t,e)=>{try{return window.katex.renderToString(e,{displayMode:!0,throwOnError:!1})}catch(e){return t}}),r=r.replace(/\\\((.+?)\\\)/g,(t,e)=>{try{return window.katex.renderToString(e,{throwOnError:!1})}catch(e){return t}}),r=r.replace(/(?<!\$)\$(?!\$)(.+?)(?<!\$)\$(?!\$)/g,(t,e)=>{try{return window.katex.renderToString(e,{throwOnError:!1})}catch(e){return t}})):r=r.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/\n/g,"<br/>"),{__html:r}}function c(t){return t&&(t.firstName&&String(t.firstName).trim()||t.name&&String(t.name).trim().split(/\s+/)[0]||t.email&&String(t.email).split("@")[0])||""}function u(t){const e=t.slice();for(let t=e.length-1;t>0;t--){const r=Math.floor(Math.random()*(t+1));[e[t],e[r]]=[e[r],e[t]]}return e}}}]);