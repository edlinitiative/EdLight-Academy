"use strict";(self.webpackChunkedlight_academy=self.webpackChunkedlight_academy||[]).push([[11],{6011:(e,a,t)=>{t.r(a),t.d(a,{default:()=>f});var s=t(4705),n=t(6540),i=t(7767),l=t(1444),c=t(7028),r=t(3212),o=t(9920),d=t(4848);function m(e,a){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);a&&(s=s.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),t.push.apply(t,s)}return t}function x(e){for(var a=1;a<arguments.length;a++){var t=null!=arguments[a]?arguments[a]:{};a%2?m(Object(t),!0).forEach(function(a){(0,s.A)(e,a,t[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):m(Object(t)).forEach(function(a){Object.defineProperty(e,a,Object.getOwnPropertyDescriptor(t,a))})}return e}function u(e,a){return e._displayNumber||String(a+1)}const h=/_{4,}|\.{4,}/g;function _(e){let{title:a,instructions:t}=e;const[s,i]=(0,n.useState)(!1),l=!(null==t||!t.trim());return(0,d.jsxs)("div",{className:"exam-take__section-header",children:[(0,d.jsxs)("div",{className:"exam-take__section-header-top",onClick:()=>l&&i(e=>!e),role:l?"button":void 0,tabIndex:l?0:void 0,onKeyDown:e=>{!l||"Enter"!==e.key&&" "!==e.key||(e.preventDefault(),i(e=>!e))},children:[(0,d.jsx)("h3",{children:a}),l&&(0,d.jsx)("button",{className:"exam-take__section-toggle",type:"button","aria-label":s?"Afficher les instructions":"Masquer les instructions",tabIndex:-1,children:s?"‚ñ∂":"‚ñº"})]}),l&&!s&&(0,d.jsx)(r.A,{text:t})]})}function p(e){let{text:a,index:t,value:s,onChange:i}=e;const l=a.split(h),c=l.length-1,r=c>1?(s||"").split("|").concat(Array(c).fill("")).slice(0,c):[s||""],o=/^\s*\(([^)]+)\)/;return(0,d.jsx)("div",{className:"exam-take__fill-blank-text",children:l.map((e,a)=>{let s="",l=e;if(a>0){const a=e.match(o);a&&(s=a[1],l=e.slice(a[0].length))}return(0,d.jsxs)(n.Fragment,{children:[a>0&&(0,d.jsxs)("span",{className:"exam-take__inline-blank-wrap",children:[s&&(0,d.jsx)("span",{className:"exam-take__inline-blank-hint",children:s}),(0,d.jsx)("input",{type:"text",className:"exam-take__inline-blank",value:r[a-1],onChange:e=>((e,a)=>{if(c<=1)i(t,a);else{const s=[...r];s[e]=a,i(t,s.join("|"))}})(a-1,e.target.value),placeholder:s||"‚Ä¶",autoComplete:"off",spellCheck:"false",style:s?{minWidth:"".concat(Math.max(.6*s.length+2,5),"em")}:void 0})]}),l&&(0,d.jsx)("span",{children:l})]},a)})})}function j(e){let{question:a,index:t,value:s,onChange:n}=e;const i=a.type||"unknown";switch(i){case"multiple_choice":return(0,d.jsx)(v,{question:a,index:t,value:s,onChange:n});case"true_false":return(0,d.jsx)(k,{index:t,value:s,onChange:n});case"fill_blank":case"calculation":case"short_answer":default:return(0,d.jsx)(g,{type:i,index:t,value:s,onChange:n});case"essay":return(0,d.jsx)(N,{index:t,value:s,onChange:n});case"matching":return(0,d.jsx)(b,{question:a,index:t,value:s,onChange:n})}}function v(e){let{question:a,index:t,value:s,onChange:n}=e;const i=a.options||{},l=Object.entries(i);return 0===l.length?(0,d.jsxs)("div",{className:"exam-take__no-options",children:[(0,d.jsx)("p",{children:"Options non disponibles pour cette question. Tapez votre r√©ponse :"}),(0,d.jsx)("input",{className:"exam-take__text-input",type:"text",value:s,onChange:e=>n(t,e.target.value),placeholder:"Votre r√©ponse‚Ä¶"})]}):(0,d.jsx)("div",{className:"exam-take__mcq-options",children:l.map(e=>{let[a,i]=e;const l=s===a;return(0,d.jsxs)("label",{className:"exam-take__mcq-option ".concat(l?"exam-take__mcq-option--selected":""),children:[(0,d.jsx)("input",{type:"radio",name:"q-".concat(t),value:a,checked:l,onChange:()=>n(t,a),className:"exam-take__mcq-radio"}),(0,d.jsx)("span",{className:"exam-take__mcq-key",children:a.toUpperCase()}),(0,d.jsx)("span",{className:"exam-take__mcq-text",children:i})]},a)})})}function k(e){let{index:a,value:t,onChange:s}=e;return(0,d.jsx)("div",{className:"exam-take__tf-options",children:[{key:"vrai",label:"‚úÖ Vrai"},{key:"faux",label:"‚ùå Faux"}].map(e=>{let{key:n,label:i}=e;const l=t===n;return(0,d.jsxs)("label",{className:"exam-take__tf-option ".concat(l?"exam-take__tf-option--selected":""),children:[(0,d.jsx)("input",{type:"radio",name:"q-".concat(a),value:n,checked:l,onChange:()=>s(a,n),className:"exam-take__tf-radio"}),(0,d.jsx)("span",{children:i})]},n)})})}function g(e){let{type:a,index:t,value:s,onChange:n}=e;return(0,d.jsx)("input",{className:"exam-take__text-input",type:"text",value:s,onChange:e=>n(t,e.target.value),placeholder:{fill_blank:"Compl√©tez le blanc‚Ä¶",calculation:"Entrez votre r√©sultat‚Ä¶",short_answer:"Votre r√©ponse‚Ä¶"}[a]||"Votre r√©ponse‚Ä¶"})}function N(e){let{index:a,value:t,onChange:s}=e;return(0,d.jsx)("textarea",{className:"exam-take__essay-input",value:t,onChange:e=>s(a,e.target.value),placeholder:"R√©digez votre r√©ponse ici‚Ä¶",rows:8})}function b(e){let{question:a,index:t,value:s,onChange:n}=e;return(0,d.jsxs)("div",{className:"exam-take__matching",children:[(0,d.jsx)("p",{className:"exam-take__matching-hint",children:"Entrez vos correspondances (ex: 1-B, 2-A, 3-C)"}),(0,d.jsx)("input",{className:"exam-take__text-input",type:"text",value:s,onChange:e=>n(t,e.target.value),placeholder:"1-B, 2-A, 3-C‚Ä¶"})]})}const f=()=>{var e,a,t;const{examIndex:s}=(0,i.g)(),m=(0,i.Zp)(),{data:h,isLoading:v,error:k}=(0,l.I)({queryKey:["exam-catalog"],queryFn:async()=>{const e=await fetch("/exam_catalog.json");if(!e.ok)throw new Error("Failed to load exam catalog");return e.json()},staleTime:1/0}),g=parseInt(s,10),N=null==h?void 0:h[g],b=(0,n.useMemo)(()=>N?(0,o.Y)(N):[],[N]),f=(0,n.useMemo)(()=>{const e=[];for(let s=0;s<b.length;s++){var a,t;const n=String((null===(a=b[s])||void 0===a?void 0:a.sectionTitle)||"").trim()||"Questions",i=String((null===(t=b[s])||void 0===t?void 0:t.sectionInstructions)||"").trim(),l=e[e.length-1];l&&l.title===n&&l.instructions===i?l.end=s:e.push({title:n,instructions:i,start:s,end:s})}return e.map(e=>x(x({},e),{},{count:e.end-e.start+1}))},[b]),[y,C]=(0,n.useState)(!1),w=(0,n.useMemo)(()=>{if(!N)return null;let e=[];const a=(N.sections||[]).map(a=>{const t=(a.instructions||"").trim(),{rules:s,cleanedText:n}=(0,o.P5)(t);return s.length&&e.push(...s),x(x({},a),{},{_cleanInstructions:n})}),t=new Set;return{rules:e.filter(e=>{const a=e.toLowerCase().replace(/[^a-z√†-√ø0-9]/gi,"").slice(0,40);return!t.has(a)&&(t.add(a),!0)}),cleanedSections:a}},[N]),[q,S]=(0,n.useState)(0),[E,I]=(0,n.useState)({}),[O,A]=(0,n.useState)(!1),[P,T]=(0,n.useState)(!1),D=(null==N?void 0:N.duration_minutes)||0,[L,M]=(0,n.useState)(60*D),V=(0,n.useRef)(null);(0,n.useEffect)(()=>{if(D&&!O)return M(60*D),V.current=setInterval(()=>{M(e=>e<=1?(clearInterval(V.current),0):e-1)},1e3),()=>clearInterval(V.current)},[D,O]),(0,n.useEffect)(()=>{D&&0===L&&!O&&Z()},[L]);const F=e=>{const a=Math.floor(e/3600),t=Math.floor(e%3600/60),s=e%60;return a>0?"".concat(a,":").concat(String(t).padStart(2,"0"),":").concat(String(s).padStart(2,"0")):"".concat(t,":").concat(String(s).padStart(2,"0"))},z=(0,n.useCallback)((e,a)=>{I(t=>x(x({},t),{},{[e]:a}))},[]),R=Object.keys(E).filter(e=>""!==E[e]&&null!=E[e]).length,G=b.length>0?Math.round(R/b.length*100):0;(0,n.useEffect)(()=>{const e=e=>{"INPUT"===e.target.tagName||"TEXTAREA"===e.target.tagName||e.target.isContentEditable||("ArrowRight"===e.key||"ArrowDown"===e.key?(e.preventDefault(),S(e=>Math.min(e+1,b.length-1))):"ArrowLeft"!==e.key&&"ArrowUp"!==e.key||(e.preventDefault(),S(e=>Math.max(e-1,0))))};return window.addEventListener("keydown",e),()=>window.removeEventListener("keydown",e)},[b.length]);const $=(0,n.useRef)(null);(0,n.useEffect)(()=>{var e;null===(e=$.current)||void 0===e||e.scrollIntoView({behavior:"smooth",block:"start"})},[q]);const[B,U]=(0,n.useState)(!1),Z=(0,n.useCallback)(()=>{clearInterval(V.current),A(!0);const e=(0,o.$4)(b,E);sessionStorage.setItem("exam-result-".concat(g),JSON.stringify({examIndex:g,examTitle:(0,o.Vj)(N),subject:(0,o.c$)(N.subject),level:(0,o.yf)(N.level),result:e,timestamp:Date.now()})),m("/exams/".concat(g,"/results"))},[b,E,g,N,m]);if(v)return(0,d.jsx)("section",{className:"section",children:(0,d.jsx)("div",{className:"container",children:(0,d.jsx)("div",{className:"card card--centered card--loading",children:(0,d.jsx)("div",{className:"loading-spinner"})})})});if(k||!N)return(0,d.jsx)("section",{className:"section",children:(0,d.jsx)("div",{className:"container",children:(0,d.jsxs)("div",{className:"card card--message",children:[(0,d.jsx)("p",{children:"Examen introuvable."}),(0,d.jsx)("button",{className:"button button--primary",onClick:()=>m("/exams"),children:"‚Üê Retour aux examens"})]})})});const K=(0,o.c$)(N.subject),Q=(0,o.cS)(K);if(!y){var Y;const e=(N.sections||[]).map((e,a)=>({title:e.section_title||"Section ".concat(a+1),qCount:(e.questions||[]).length})),a=e.reduce((e,a)=>e+a.qCount,0);return(0,d.jsx)("section",{className:"section",children:(0,d.jsx)("div",{className:"container",children:(0,d.jsxs)("div",{className:"exam-intro",children:[(0,d.jsxs)("div",{className:"exam-intro__header",children:[(0,d.jsx)("button",{className:"button button--ghost button--sm",onClick:()=>m("/exams"),children:"‚Üê Retour aux examens"}),(0,d.jsx)("span",{className:"exam-intro__subject",style:{background:Q+"14",color:Q,borderColor:Q+"30"},children:K})]}),(0,d.jsx)("h1",{className:"exam-intro__title",children:(0,o.Vj)(N)}),(0,d.jsxs)("div",{className:"exam-intro__meta",children:[D>0&&(0,d.jsxs)("div",{className:"exam-intro__chip",children:[(0,d.jsx)("span",{className:"exam-intro__chip-icon",children:"‚è±"}),(0,d.jsxs)("span",{children:[D," minutes"]})]}),N.total_points>0&&(0,d.jsxs)("div",{className:"exam-intro__chip",children:[(0,d.jsx)("span",{className:"exam-intro__chip-icon",children:"üéØ"}),(0,d.jsxs)("span",{children:[N.total_points," points"]})]}),(0,d.jsxs)("div",{className:"exam-intro__chip",children:[(0,d.jsx)("span",{className:"exam-intro__chip-icon",children:"üìù"}),(0,d.jsxs)("span",{children:[a," questions"]})]}),(0,d.jsxs)("div",{className:"exam-intro__chip",children:[(0,d.jsx)("span",{className:"exam-intro__chip-icon",children:"üìë"}),(0,d.jsxs)("span",{children:[e.length," section",e.length>1?"s":""]})]}),N.language&&(0,d.jsxs)("div",{className:"exam-intro__chip",children:[(0,d.jsx)("span",{className:"exam-intro__chip-icon",children:"üåê"}),(0,d.jsx)("span",{children:N.language})]})]}),(null==w||null===(Y=w.rules)||void 0===Y?void 0:Y.length)>0&&(0,d.jsxs)("div",{className:"exam-intro__rules",children:[(0,d.jsx)("h3",{className:"exam-intro__rules-title",children:"üìã Consignes de l'examen"}),(0,d.jsx)("ul",{className:"exam-intro__rules-list",children:w.rules.map((e,a)=>(0,d.jsxs)("li",{className:"exam-intro__rule",children:[(0,d.jsx)("span",{className:"exam-intro__rule-icon",children:e.toLowerCase().includes("interdit")?"üö´":e.toLowerCase().includes("silence")?"ü§´":e.toLowerCase().includes("obligatoire")?"‚ö†Ô∏è":e.toLowerCase().includes("dur√©e")||e.toLowerCase().includes("heure")?"‚è∞":e.toLowerCase().includes("coefficient")?"üìä":"‚ÑπÔ∏è"}),(0,d.jsx)("span",{children:e})]},a))})]}),(0,d.jsxs)("div",{className:"exam-intro__sections",children:[(0,d.jsx)("h3",{className:"exam-intro__sections-title",children:"Structure de l'examen"}),(0,d.jsx)("div",{className:"exam-intro__section-list",children:e.map((e,a)=>(0,d.jsxs)("div",{className:"exam-intro__section-item",children:[(0,d.jsx)("span",{className:"exam-intro__section-num",children:a+1}),(0,d.jsx)("span",{className:"exam-intro__section-name",children:e.title}),(0,d.jsxs)("span",{className:"exam-intro__section-count",children:[e.qCount," q."]})]},a))})]}),(0,d.jsx)("button",{className:"button button--primary exam-intro__start",onClick:()=>C(!0),children:"Commencer l'examen ‚Üí"})]})})})}const J=b[q];if(!J)return null;const W=(0,o._Y)(J.type),X=D&&L<300,H=(N.sections||[]).findIndex(e=>e.section_title===J.sectionTitle),ee=(null==w||null===(e=w.cleanedSections)||void 0===e||null===(e=e[H])||void 0===e?void 0:e._cleanInstructions)||J.sectionInstructions||"";return(0,d.jsx)("section",{className:"section exam-take",children:(0,d.jsxs)("div",{className:"container",children:[(0,d.jsxs)("div",{className:"exam-take__topbar",children:[(0,d.jsxs)("div",{className:"exam-take__topbar-left",children:[(0,d.jsx)("button",{className:"button button--ghost button--sm",onClick:()=>m("/exams"),children:"‚Üê Examens"}),(0,d.jsxs)("div",{className:"exam-take__exam-info",children:[(0,d.jsx)("span",{className:"exam-take__subject",style:{color:Q},children:K}),(0,d.jsx)("span",{className:"exam-take__title-short",children:(0,o.Vj)(N)})]})]}),(0,d.jsxs)("div",{className:"exam-take__topbar-right",children:[(0,d.jsxs)("span",{className:"exam-take__progress",children:[R,"/",b.length]}),D>0&&(0,d.jsxs)("span",{className:"exam-take__timer ".concat(X?"exam-take__timer--warning":""),"aria-live":"polite","aria-label":"Temps restant: ".concat(F(L)),children:[(0,d.jsx)("span",{"aria-hidden":"true",children:"‚è±"})," ",F(L)]}),(0,d.jsx)("button",{className:"button button--primary button--sm",onClick:()=>T(!0),children:"Soumettre"})]})]}),(0,d.jsx)("div",{className:"exam-take__progress-bar",role:"progressbar","aria-valuenow":G,"aria-valuemin":0,"aria-valuemax":100,children:(0,d.jsx)("div",{className:"exam-take__progress-fill",style:{width:"".concat(G,"%")}})}),(0,d.jsxs)("div",{className:"exam-take__body",children:[(0,d.jsxs)("aside",{className:"exam-take__nav",children:[(0,d.jsx)("div",{className:"exam-take__nav-header",children:"Sections"}),(0,d.jsx)("div",{className:"exam-take__nav-sections",role:"navigation","aria-label":"Navigation des questions par section",children:f.map(e=>{const a=q>=e.start&&q<=e.end;return(0,d.jsxs)("div",{className:"exam-take__nav-section",children:[(0,d.jsxs)("div",{className:"exam-take__nav-section-title ".concat(a?"exam-take__nav-section-title--current":""),children:[(0,d.jsx)("span",{className:"exam-take__nav-section-name",children:e.title}),(0,d.jsx)("span",{className:"exam-take__nav-section-count",children:e.count})]}),(0,d.jsx)("div",{className:"exam-take__nav-section-grid",children:Array.from({length:e.count}).map((a,t)=>{const s=e.start+t,n=b[s],i=null!=E[s]&&""!==E[s];let l="exam-take__nav-btn";s===q?l+=" exam-take__nav-btn--current":i&&(l+=" exam-take__nav-btn--answered");const c=function(e,a){const t=e._displayNumber;if(!t)return String(a+1);if(t.length<=6)return t;const s=t.match(/^([A-Z]+[\-.]?)\s*.*?(\d+)$/i);return s?s[1]+s[2]:t.slice(0,5)+"‚Ä¶"}(n,s);return(0,d.jsx)("button",{className:l,onClick:()=>S(s),title:"Question ".concat(u(n,s)),type:"button",children:c},s)})})]},"".concat(e.start,"-").concat(e.end,"-").concat(e.title))})})]}),(0,d.jsxs)("div",{className:"exam-take__content",ref:$,children:[J.sectionTitle&&(0,d.jsx)(_,{title:J.sectionTitle,instructions:ee}),ee&&ee.length>200&&(0,d.jsx)("button",{className:"exam-take__passage-btn",onClick:()=>U(!0),type:"button",children:"üìñ Voir le texte"}),J._subExFirstInGroup&&J._subExDirective&&(0,d.jsxs)("div",{className:"exam-take__subex-header",children:[(0,d.jsxs)("span",{className:"exam-take__subex-label",children:[J._subExGroup,"."]}),(0,d.jsx)("span",{className:"exam-take__subex-directive",children:J._subExDirective.replace(/^[A-Z][.\-)\s]+/,"")})]}),J._wordPool&&J._subExFirstInGroup&&(0,d.jsxs)("div",{className:"exam-take__word-pool",children:[(0,d.jsx)("span",{className:"exam-take__word-pool-label",children:"Banque de mots :"})," ",(0,d.jsx)("span",{className:"exam-take__word-pool-words",children:J._wordPool})]}),J._wordPool&&!J._subExFirstInGroup&&(0,d.jsx)("div",{className:"exam-take__word-pool exam-take__word-pool--compact",children:(0,d.jsx)("span",{className:"exam-take__word-pool-words",children:J._wordPool})}),(0,d.jsxs)("div",{className:"card exam-take__question-card",children:[(0,d.jsxs)("div",{className:"exam-take__question-header",children:[(0,d.jsxs)("span",{className:"exam-take__question-number",children:[(0,d.jsx)("span",{className:"exam-take__question-num-label",children:u(J,q)}),(0,d.jsxs)("span",{className:"exam-take__question-num-total",children:[" / ",b.length]})]}),(0,d.jsxs)("span",{className:"exam-take__question-type",style:{background:Q+"18",color:Q},children:[W.icon," ",W.label]}),J.points&&(0,d.jsxs)("span",{className:"exam-take__question-points",children:[J.points," pt",1!==J.points?"s":""]})]}),J.has_figure&&J.figure_description&&(0,d.jsx)(c.A,{description:J.figure_description}),"fill_blank"===J.type&&(ae=J._displayText||J.question,/_{4,}|\.{4,}/.test(ae))?(0,d.jsx)("div",{className:"exam-take__question-text",children:(0,d.jsx)(p,{text:J._displayText||J.question,index:q,value:null!==(a=E[q])&&void 0!==a?a:"",onChange:z})}):(0,d.jsxs)(d.Fragment,{children:[(0,d.jsx)("div",{className:"exam-take__question-text",children:(0,d.jsx)(r.A,{text:J._displayText||J.question})}),(0,d.jsx)("div",{className:"exam-take__answer-area",children:(0,d.jsx)(j,{question:J,index:q,value:null!==(t=E[q])&&void 0!==t?t:"",onChange:z})})]})]}),(0,d.jsxs)("div",{className:"exam-take__question-nav",children:[(0,d.jsx)("button",{className:"button button--ghost",disabled:0===q,onClick:()=>S(e=>e-1),children:"‚Üê Pr√©c√©dent"}),q<b.length-1?(0,d.jsx)("button",{className:"button button--primary",onClick:()=>S(e=>e+1),children:"Suivant ‚Üí"}):(0,d.jsx)("button",{className:"button button--primary",onClick:()=>T(!0),children:"Terminer l'examen"})]})]})]}),P&&(0,d.jsx)("div",{className:"exam-take__overlay",onClick:()=>T(!1),children:(0,d.jsxs)("div",{className:"exam-take__modal card",onClick:e=>e.stopPropagation(),children:[(0,d.jsx)("h3",{children:"Soumettre l'examen ?"}),(0,d.jsxs)("p",{children:["Vous avez r√©pondu √† ",(0,d.jsx)("strong",{children:R})," sur"," ",(0,d.jsx)("strong",{children:b.length})," questions.",R<b.length&&(0,d.jsxs)("span",{className:"exam-take__modal-warning",children:[" ","‚ö†Ô∏è ",b.length-R," question",b.length-R>1?"s":""," sans r√©ponse."]})]}),(0,d.jsxs)("div",{className:"exam-take__modal-actions",children:[(0,d.jsx)("button",{className:"button button--ghost",onClick:()=>T(!1),children:"Continuer l'examen"}),(0,d.jsx)("button",{className:"button button--primary",onClick:Z,children:"Soumettre maintenant"})]})]})}),B&&(0,d.jsx)("div",{className:"exam-take__overlay",onClick:()=>U(!1),children:(0,d.jsxs)("div",{className:"exam-take__passage-panel",onClick:e=>e.stopPropagation(),children:[(0,d.jsxs)("div",{className:"exam-take__passage-panel-header",children:[(0,d.jsx)("h3",{children:"üìñ Texte de r√©f√©rence"}),(0,d.jsx)("button",{className:"exam-take__passage-panel-close",onClick:()=>U(!1),type:"button",children:"‚úï"})]}),(0,d.jsx)("div",{className:"exam-take__passage-panel-body",children:(0,d.jsx)(r.A,{text:ee})})]})})]})});var ae}}}]);