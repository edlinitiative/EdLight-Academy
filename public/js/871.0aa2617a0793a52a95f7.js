"use strict";(self.webpackChunkedlight_academy=self.webpackChunkedlight_academy||[]).push([[871],{4867:(t,e,o)=>{function n(t){const e=[];let o=0,n="",r=[],i=!1;for(;o<=t.length;){const c=t[o]||"\n";i?'"'===c?'"'===t[o+1]?(n+='"',o++):i=!1:n+=c:'"'===c?i=!0:","===c?(r.push(n),n=""):"\n"===c||"\r"===c?((n.length||r.length)&&(r.push(n),e.push(r.map(t=>t.trim()))),n="",r=[],"\r"===c&&"\n"===t[o+1]&&o++):n+=c,o++}const[c,...s]=e;return s.map(t=>Object.fromEntries(c.map((e,o)=>{var n;return[e,null!==(n=t[o])&&void 0!==n?n:""]})))}async function r(t){try{const e=await fetch(t);if(!e.ok)throw new Error("Failed to fetch ".concat(t,": ").concat(e.status," ").concat(e.statusText));return n(await e.text())}catch(e){throw console.error("Error loading CSV from ".concat(t,":"),e),e}}o.d(e,{F:()=>r,parseCSV:()=>n})},7280:(t,e,o)=>{o.r(e),o.d(e,{indexQuizBank:()=>p,loadQuizBankSafe:()=>a,normalizeAndIndexQuizBank:()=>m,pickRandomQuestion:()=>f,toDirectItemFromRow:()=>l,toPerseusItemFromRow:()=>d});var n=o(4705),r=o(4867);function i(t,e){var o=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})),o.push.apply(o,n)}return o}function c(t){for(var e=1;e<arguments.length;e++){var o=null!=arguments[e]?arguments[e]:{};e%2?i(Object(o),!0).forEach(function(e){(0,n.A)(t,e,o[e])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(o)):i(Object(o)).forEach(function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(o,e))})}return t}const s=["/data/edlight_unified_quiz_database_expanded_with_chapters.csv","/data/edlight_unified_quiz_database_expanded.csv","/data/edlight_unified_quiz_database.csv"];async function a(){for(const t of s)try{const e=await(0,r.F)(t);return console.info("[QuizBank] Loaded bank CSV:",t,"rows:",e.length),e}catch(t){continue}return console.warn("[QuizBank] No quiz bank CSV found from candidates:",s.join(", ")),[]}const u=function(t,e){let o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"";for(const o of e)if(void 0!==t[o]&&null!==t[o]&&""!==String(t[o]).trim())return t[o];return o};function d(t){const e=String(u(t,["question","question_text","prompt","stem"],"")).trim(),o=String(u(t,["question_type","type","qtype"],"")).trim(),n=o?o.toLowerCase():"";let r=[];const i=u(t,["options","choices"],"");if(i)try{const t=JSON.parse(i);Array.isArray(t)&&(r=t.map(t=>String(t)))}catch(t){}if(0===r.length){const e=[["option_a","optionA","A","choice_a","Choice A","choice_1","option1"],["option_b","optionB","B","choice_b","Choice B","choice_2","option2"],["option_c","optionC","C","choice_c","Choice C","choice_3","option3"],["option_d","optionD","D","choice_d","Choice D","choice_4","option4"]];for(const o of e){const e=u(t,o,"");""!==String(e).trim()&&r.push(String(e))}}const c=String(u(t,["correct_option","correctOption","answer","correct","key","correct_answer"],"")).trim(),s=[],a=["hint","hint1","hint_1","explanation","solution","rationale"];for(const e of a){const o=u(t,[e],"");""!==String(o).trim()&&s.push(String(o))}if("truefalse"===n||"true/false"===n||"tf"===n){const t=r.length>=2?r:["True","False"],o=c.toLowerCase(),n=o.startsWith("t")?0:o.startsWith("f")?1:t.findIndex(t=>t.trim().toLowerCase()===o),i=n>=0?n:0;return{question:{content:"".concat(e,"\n\n[[☃ multiple-choice 1]]"),images:{},widgets:{"multiple-choice 1":{type:"multiple-choice",graded:!0,options:{choices:t.slice(0,2).map((t,e)=>({content:t,correct:e===i})),randomize:!1},version:{major:0,minor:0}}}},answerArea:{calculator:!1},hints:s.map(t=>({content:t})),itemDataVersion:{major:0,minor:1}}}if("shortanswer"===n||"short"===n||"sa"===n||0===r.length&&c)return{question:{content:"".concat(e,"\n\n[[☃ text-input 1]]"),images:{},widgets:{"text-input 1":{type:"text-input",graded:!0,options:{value:c||"",width:120},version:{major:0,minor:0}}}},answerArea:{calculator:!1},hints:s.map(t=>({content:t})),itemDataVersion:{major:0,minor:1}};let d=-1;if(/^[A-D]$/i.test(c))d=c.toUpperCase().charCodeAt(0)-"A".charCodeAt(0);else if(/^[1-9]$/.test(c))d=parseInt(c,10)-1;else if(c){const t=r.findIndex(t=>t.trim().toLowerCase()===c.trim().toLowerCase());-1!==t&&(d=t)}return r.length>=2&&d>=0?{question:{content:"".concat(e,"\n\n[[☃ multiple-choice 1]]"),images:{},widgets:{"multiple-choice 1":{type:"multiple-choice",graded:!0,options:{choices:r.map((t,e)=>({content:t,correct:e===d})),randomize:!0},version:{major:0,minor:0}}}},answerArea:{calculator:!1},hints:s.map(t=>({content:t})),itemDataVersion:{major:0,minor:1}}:{question:{content:"".concat(e,"\n\n[[☃ text-input 1]]"),images:{},widgets:{"text-input 1":{type:"text-input",graded:!0,options:{value:c||"",width:120},version:{major:0,minor:0}}}},answerArea:{calculator:!1},hints:s.map(t=>({content:t})),itemDataVersion:{major:0,minor:1}}}function l(t){const e=String(u(t,["question","question_text","prompt","stem"],"")).trim(),o=String(u(t,["question_type","type","qtype"],"")).trim().toLowerCase(),n=String(u(t,["good_response","good","explanation"],"")).trim(),r=String(u(t,["wrong_response","wrong","feedback"],"")).trim(),i=[];for(const e of["hint","hint1","hint_1","hint2","hint_2","hint3","hint_3","rationale"]){const o=u(t,[e],"");""!==String(o).trim()&&i.push(String(o))}let c=[];const s=u(t,["options","choices"],"");if(s)try{const t=JSON.parse(s);Array.isArray(t)&&(c=t.map(t=>String(t)))}catch(t){}if(0===c.length){const e=[["option_a","optionA","A","choice_a","Choice A","choice_1","option1"],["option_b","optionB","B","choice_b","Choice B","choice_2","option2"],["option_c","optionC","C","choice_c","Choice C","choice_3","option3"],["option_d","optionD","D","choice_d","Choice D","choice_4","option4"]];for(const o of e){const e=u(t,o,"");""!==String(e).trim()&&c.push(String(e))}}const a=String(u(t,["correct_option","correctOption","answer","correct","key","correct_answer"],"")).trim();if("truefalse"===o||"true/false"===o||"tf"===o){var d;const t=c.length>=2?c.slice(0,2):["True","False"];let o=0;const s=a.toLowerCase();if(s.startsWith("f"))o=1;else if(s.startsWith("t"))o=0;else{const e=t.findIndex(t=>t.trim().toLowerCase()===s);e>=0&&(o=e)}const u=null!==(d=t[o])&&void 0!==d?d:"True";return{kind:"tf",stem:e,options:t,correctIndex:o,correctLabel:u,hints:i,good:n,wrong:r}}return"shortanswer"===o||"short"===o||"sa"===o||0===c.length&&a?{kind:"short",stem:e,correctText:a,hints:i,good:n,wrong:r}:(()=>{let t=-1;if(/^[A-D]$/i.test(a))t=a.toUpperCase().charCodeAt(0)-"A".charCodeAt(0);else if(/^[1-9]$/.test(a))t=parseInt(a,10)-1;else if(a){const e=c.findIndex(t=>t.trim().toLowerCase()===a.trim().toLowerCase());-1!==e&&(t=e)}if(c.length>=2&&t>=0){const o=c[t];return{kind:"mcq",stem:e,options:c,correctIndex:t,correctLabel:o,hints:i,good:n,wrong:r}}return{kind:"short",stem:e,correctText:a,hints:i,good:n,wrong:r}})()}function p(t){const e={},o={},n=t=>{const e=String(t||"").toUpperCase().replace(/\s+/g," ").trim(),o=e.match(/NS\s*(I{1,3}|IV)\b/);if(o)return"NS".concat(o[1]);const n=e.match(/NS\s*(\d)\b/);if(n)return"NS".concat("I".repeat(parseInt(n[1],10)));const r=e.match(/NS(IV|III|II|I)\b/);return r?"NS".concat(r[1]):"NSI"},r=t=>{const e=String(u(t,["subject_code","course_code"],"")).trim();if(e){const t=e.split("-");if(2===t.length){const e=t[0].toUpperCase(),o=n(t[1]);return"".concat(e,"-").concat(o)}return e.toUpperCase()}const o=(t=>{const e=String(t||"").trim().toLowerCase();return e?/(chem|chim)/.test(e)?"CHEM":/(phys)/.test(e)?"PHYS":/(math)/.test(e)?"MATH":/(econ|écon|econo)/.test(e)?"ECON":e.toUpperCase():""})(u(t,["subject","course","discipline"],"")),r=n(u(t,["level","grade"],""));return o&&r?"".concat(o,"-").concat(r):""},i=t=>{let e=String(u(t,["Chapter_Number","chapter_number"],"")).trim();if(e){const t=e.match(/^(\d{1,2})/);if(t)return"U".concat(t[1])}let o=u(t,["unit_no","unit_number"],"").toString().trim();if(o||(o=u(t,["unit"],"").toString().trim()),!o)return"";const n=o.match(/\b(\d{1,2})\b/);if(n)return"U".concat(n[1]);const r=o.match(/U\s*(\d{1,2})/i);return r?"U".concat(r[1]):""};for(const n of t){const t=r(n);if(!t)continue;(o[t]=o[t]||[]).push(n);const c=i(n);if(c){const o="".concat(t,"|").concat(c);(e[o]=e[o]||[]).push(n)}}return{byUnit:e,bySubject:o}}const h=t=>String(t||"").toLowerCase().replace(/[\u2012-\u2015]/g,"-").replace(/[^a-z0-9\s-]/g,"").replace(/\s+/g," ").trim();function m(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];const o=t.map(t=>{const o=(()=>{const e=(t.subject_code||t.course_code||"").toString().trim();if(e)return e;const o=String(t.subject||"").toLowerCase(),n=o.includes("chem")||o.includes("chim")?"CHEM":o.includes("phys")?"PHYS":o.includes("math")?"MATH":o.includes("econ")?"ECON":(t.subject||"").toString().toUpperCase(),r=String(t.level||"").toUpperCase(),i=r.match(/NS\s*(IV|III|II|I)\b/),c=r.match(/NS\s*(\d)\b/),s=r.match(/NS(IV|III|II|I)\b/),a=i?"NS".concat(i[1]):c?"NS".concat("I".repeat(parseInt(c[1],10))):s?"NS".concat(s[1]):"NSI";return"".concat(n,"-").concat(a)})();let n=(()=>{const e=(t.unit_no||t.unit_number||t.unit||"").toString(),o=e.match(/\b(\d{1,2})\b/);if(o)return o[1];const n=e.match(/U\s*(\d{1,2})/i);return n?n[1]:""})(),r="";const i=function(t,e){if(!Array.isArray(e)||0===e.length)return null;const o=String(t.subject_code||"").trim()||(()=>{const e=String(t.subject||"").trim(),o=String(t.level||"").trim();if(!e||!o)return"";const n=e.toLowerCase().includes("chem")||e.toLowerCase().includes("chim")?"CHEM":e.toLowerCase().includes("phys")?"PHYS":e.toLowerCase().includes("math")?"MATH":e.toLowerCase().includes("econ")?"ECON":e.toUpperCase(),r=o.toUpperCase().match(/NS\s*(IV|III|II|I)\b/),i=o.toUpperCase().match(/NS\s*(\d)\b/),c=o.toUpperCase().match(/NS(IV|III|II|I)\b/),s=r?"NS".concat(r[1]):i?"NS".concat("I".repeat(parseInt(i[1],10))):c?"NS".concat(c[1]):"NSI";return"".concat(n,"-").concat(s)})(),n=(()=>{const e=(t.unit_no||t.unit_number||t.unit||"").toString(),o=e.match(/\b(\d{1,2})\b/);if(o)return o[1];const n=e.match(/U\s*(\d{1,2})/i);return n?n[1]:""})(),r=function(t){const e=String(u(t,["Chapter_Number","chapter_number","chapterNo","chapter","lesson_no","lesson_number","Subchapter_Number","subchapter_number"],"")).trim();if(!e)return"";const o=e.match(/^(\d+)(?:[\.-]\d+)?$/);if(o)return o[1];const n=e.match(/\b(\d{1,2})\b/);return n?n[1]:""}(t),i=h(t.video_title||t.question||""),c=e.filter(t=>!o||t.subject_code===o);if(o&&n&&r){const t=c.find(t=>String(t.unit_no)===String(n)&&String(t.lesson_no)===String(r));if(t)return{video:t,subject_code:t.subject_code,unit_no:String(t.unit_no)}}let s=null;for(const t of c){if(!t.video_title)continue;const e=h(t.video_title);if(e&&i&&(e.includes(i)||i.includes(e))){s=t;break}}if(s)return{video:s,subject_code:s.subject_code,unit_no:String(s.unit_no||"").trim()};if(o&&n){const t=c.find(t=>String(t.unit_no)===String(n));if(t)return{video:t,subject_code:t.subject_code,unit_no:String(t.unit_no)}}return null}(t,e);var s;return i&&(r=(null===(s=i.video)||void 0===s?void 0:s.id)||"",!n&&i.unit_no&&(n=i.unit_no)),c(c({},t),{},{subject_code_norm:o,unit_no_norm:n,unit_id_norm:n?"U".concat(n):"",video_id_match:r})}),n={},r={},i={};for(const t of o){if(t.subject_code_norm&&((r[t.subject_code_norm]=r[t.subject_code_norm]||[]).push(t),t.unit_no_norm)){const e="".concat(t.subject_code_norm,"|U").concat(t.unit_no_norm);(n[e]=n[e]||[]).push(t)}t.video_id_match&&(i[t.video_id_match]=i[t.video_id_match]||[]).push(t)}return{rows:o,byUnit:n,bySubject:r,byVideoId:i}}function f(t,e,o,n){const r="".concat(e,"|").concat(o);let i=t&&t[r]||[];return 0===i.length&&n&&(i=n[e]||[]),0===i.length?null:i[Math.floor(Math.random()*i.length)]}},9871:(t,e,o)=>{o.d(e,{dp:()=>f});var n=o(1444),r=o(4705),i=o(7280),c=o(7016),s=o(4589);function a(t,e){var o=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})),o.push.apply(o,n)}return o}function u(t){for(var e=1;e<arguments.length;e++){var o=null!=arguments[e]?arguments[e]:{};e%2?a(Object(o),!0).forEach(function(e){(0,r.A)(t,e,o[e])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(o)):a(Object(o)).forEach(function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(o,e))})}return t}const d={CHEM:{color:"#10B981",icon:"beaker",name:"Chemistry"},PHYS:{color:"#3B82F6",icon:"atom",name:"Physics"},MATH:{color:"#8B5CF6",icon:"calculator",name:"Mathematics"},ECON:{color:"#F59E0B",icon:"chart",name:"Economics"}},l=async()=>{try{const t=(0,s.rJ)(c.db,"courses"),e=await(0,s.GG)(t),o=[];return e.forEach(t=>{const e=t.data();o.push(u({id:t.id},e))}),o}catch(t){return console.error("❌ Error fetching courses from Firestore:",t),[]}},p=async()=>{try{const t=(0,s.rJ)(c.db,"videos"),e=await(0,s.GG)(t),o=new Map;return e.forEach(t=>{o.set(t.id,u({id:t.id},t.data()))}),o}catch(t){return console.error("❌ Error fetching videos from Firestore:",t),new Map}},h=async()=>{try{const t=(0,s.rJ)(c.db,"quizzes"),e=await(0,s.GG)(t),o=new Map;return e.forEach(t=>{o.set(t.id,u({id:t.id},t.data()))}),o}catch(t){return console.error("❌ Error fetching quizzes from Firestore:",t),new Map}},m=async()=>{try{const[t,e,o]=await Promise.all([l(),p(),h()]),n=function(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new Map,o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:new Map;return t.map(t=>{const[n,r]=t.id.split("-"),i=n?n.toUpperCase():"",c=r?r.toUpperCase().replace("NS","NS").replace("1","I").replace("2","II").replace("3","III").replace("4","IV"):"NSI",s="".concat(i,"-").concat(c),a=d[i]||{color:"#0A66C2",icon:"book",name:"Course"},u=(t.units||[]).map(t=>{const n=(t.lessons||[]).map(t=>{const n=t.lessonId,r=t.type;if("video"===r&&e.has(n)){const o=e.get(n);let i=o.lesson_no;if(!i){const t=n.match(/-L(\d+)$/i);t&&(i=parseInt(t[1],10))}return{id:n,title:t.title||o.title,type:r,order:t.order,videoUrl:o.video_url||"https://www.youtube.com/embed/placeholder",duration:o.duration_min||15,objectives:o.learning_objectives||"",thumbnail:o.thumbnail_url||"",unit_no:o.unit_no,lesson_no:i}}if("quiz"===r&&o.has(n)){const e=o.get(n);return{id:n,title:t.title||e.title,type:r,order:t.order,videoUrl:null,duration:e.time_limit_minutes||30,objectives:e.description||"",questionCount:e.total_questions||0,passingScore:e.passing_score||70}}return{id:n,title:t.title,type:r,order:t.order,videoUrl:"video"===r?"https://www.youtube.com/embed/placeholder":null,duration:15,objectives:""}}),r=n.find(t=>"video"===t.type&&t.unit_no),i=(null==r?void 0:r.unit_no)||t.order;return{id:t.unitId||t.id,title:t.title,order:t.order,unit_no:i,lessons:n}});return{id:t.id,code:s,name:t.display_name||t.name,level:c,subject:i,description:t.description||"",thumbnail:a.icon,color:a.color,videoCount:t.number_of_lessons||0,duration:t.length||0,modules:u,instructor:"EdLight Academy",_firestore:{number_of_units:t.number_of_units,number_of_lessons:t.number_of_lessons,created_at:t.created_at,updated_at:t.updated_at}}})}(t,e,o),r=Array.from(e.values()),c=Array.from(o.values());return{subjects:Object.entries(d).map(t=>{let[e,o]=t;return{id:e,code:e,name:o.name,color:o.color,icon:o.icon}}),videos:r,quizzes:c,courses:n,quizBank:(0,i.normalizeAndIndexQuizBank)(c,r)}}catch(t){throw console.error("❌ Failed to load application data:",t),t}};function f(){return(0,n.I)({queryKey:["appData"],queryFn:m,staleTime:3e5,cacheTime:18e5,retry:2,onError:t=>{console.error("Failed to load application data:",t)}})}}}]);